function dynamicRow(a,b,c,d,e,f,g){var h,i,j,g=g||"document_id",c=c||".row.content",e=e||"",f=f||"col-sm-4 col-sm-offset-8",k="",d=d||!1,l=null,m=$("#"+a);if(m.length>0){if(k="raci-item-table"==a?getRowOptions("raci","col-sm-12"):"file-table"==a?getRowOptions("default","col-sm-4 col-sm-offset-8 col-xs-12"):"default-no-padding"==f?getRowOptions("default","col-sm-4 col-sm-offset-8 col-xs-12 no-padding"):"default"==f?getRowOptions("default","col-sm-4 col-sm-offset-8 col-xs-12"):"col-sm-4 col-sm-offset-8 col-xs-12"!=f?getRowOptions("normal",f):getRowOptions("normal","col-sm-4 col-sm-offset-8 col-xs-12"),""!=e){console.log("second container empty");var n=$("#"+e),o=n.find(c).not(".row-options-container").outerHTML();n.append(k);var p=n.find(".row-options-container");p.hide()}m.append(k);var q=m.find(".add-row"),r=m.find(".remove-row"),s=m.find(".row-options-container"),t=m.find(c).not(".row-options-container");console.log(t);var u=t.clone();u.find("[selected=selected]").removeAttr("selected"),u.find("input[type=text]").attr("value",""),u.find("input[type=hidden]").attr("value",""),q.click(function(){var a=!0;if($(this).parents("#file-table").length){var f=$(this).closest(".row-options-container"),k=$(f).prev(),m=$(k).find(".fileinput-filename").text();""==m&&(a=!1)}1==a&&(""!=e&&p.before(o),j=ajax_add_row(controller+"/add_row",b,d,1,g),i=u.attr("id"),void 0===i||-1!=i.indexOf("-")&&(l=i.split("-")),new_clone_prefix=(void 0!==l||null!==l)&&".file-row"==c?"file-row-":"",u.attr("id",new_clone_prefix+j),u.find(".select2-container").remove(),h=u.outerHTML(),h=addValidator(h),s.before(h),autoReferenceId(j),selectEffects(),ajax_autocomplete(".new-user",".additional-user","user/search_all",".user-suggest",".autosuggest"),textareaEffects(),dateEffects(),organisation_role(),console.log("test"),r.prop("disabled",!1))}),r.click(function(){console.log(c);var a=m.find(c).not(".row-options-container").length;a>1?(ajax_add_row(controller+"/remove_row",b,d,1,g),s.prev().remove(),update_document_cost_breakdown()):r.prop("disabled",!0)})}}function getRowOptions(a,b){var c,b=b||"col-sm-4 col-sm-offset-8",a=a||"normal";return"raci"==a?(c='<tr class="row-options-container">',c+="<td></td>",c+='<td colspan="8">',c+='<div class="row">',c+='<div class="'+b+' text-right">',c+='<button type="button" class="btn btn-danger text-right remove-row"><span class="glyphicon glyphicon-minus"></span></button> <button type="button" class="btn btn-primary text-right add-row"><span class="glyphicon glyphicon-plus"></span></button>',c+="</div>",c+="</div>",c+="</td>",c+="</tr>"):"normal"==a?(c='<div class="col-xs-12 text-right row-options-container no-padding">',c+='<div class="'+b+'">',c+='<button type="button" class="btn btn-danger text-right remove-row"><span class="glyphicon glyphicon-minus"></span></button>',c+=' <button type="button" class="btn btn-primary text-right add-row"><span class="glyphicon glyphicon-plus"></span></button>',c+="</div>",c+="</div>"):(c='<div class="row content text-right row-options-container">',c+='<div class="'+b+'">',c+='<button type="button" class="btn btn-danger text-right remove-row"><span class="glyphicon glyphicon-minus"></span></button>',c+=' <button type="button" class="btn btn-primary text-right add-row"><span class="glyphicon glyphicon-plus"></span></button>',c+="</div>",c+="</div>"),c}function ajax_add_row(a,b,c,d,e){var f,d=d||1,g=$("input[name=current_step]").val(),h=$("input[name=model_id]").val(),i=$("input[name=form_id]").val(),e=e||"document_id",c=c||!1;c||(g=null);var j={id:i,current_step:g,model_id:h,table_name:b,row_count:d,db_primary:e},k=base_url+a;return $.ajax({async:!1,type:"POST",url:k,data:j,dataType:"html",success:function(a){f=a}}),f}function addValidator(a){return $object=$($.parseHTML(a)),$inputs=$object.find("[name]"),$inputs.each(function(){input_name=$(this).attr("name"),$(this).attr("data-bv-field",input_name)}),$object.outerHTML()}function autoReferenceId(a){var b=$("#action-tracker-table").find(".row, .content:first"),c=b.find(".form-group:last"),d=c.find("input").val();$("#action-tracker-table").find(".row, .content").each(function(){var b=$(this).find(".form-group:first");""==b.find("input").val()&&b.find("input").val(d+"-"+a)})}function ajax_autocomplete(a,b,c,d,e){var f,g=$(a);g.length&&$(document).on("keyup",a,function(){g=$(this);var a=g.closest(b),h=a.find(d),i=h.closest(e);if(""!=$(this).val()){var j=$(this).val(),k={id:j},l=base_url+c;$.ajax({type:"POST",url:l,data:k,dataType:"html",success:function(a){""==a?i.fadeOut("fast"):i.show(),h.is("input")?h.val(a):h.html(a),f=$(".autosuggest-options"),f.click(function(){var a=$(this).attr("id"),b=$(this).text();g.val(b),g.closest(".form-group").find("input[type=hidden]").val(a),i.fadeOut("fast")})}})}else i.fadeOut("fast")})}function textareaEffects(){$textareas=$("#summary, .textarea-editor, #case-summary"),$textareas.each(function(){$single_textarea=$(this),"#summary"==$single_textarea.attr("id")?selector_text="#summary":"#case-summary"==$single_textarea.attr("id")&&(selector_text="#case-summary"),tinymce.init({selector:determineTextareaEditor($single_textarea),height:determineEditorHeight($single_textarea),menubar:!1,statusbar:!1,resize:!0,toolbar:"bold italic | bullist numlist outdent indent | removeformat formatselect",content_css:base_url+"theme/css/plugins/tinymce_custom.css"})}),$(this).closest(".form-group").find("iframe").html()}function applyTextareaEffect(a){a.wysihtml5({stylesheets:["theme/assets/plugins/bootstrap-wysihtml5/css/wysiwyg-color.css"],size:"xs",fa:!0,color:!1,image:!1,link:!1})}function update_document_cost_breakdown(){if($("#cost-breakdown-table").find(".estimated-subtotal")){var a=$("input[name=model_id]").val(),b=base_url+"project-plan/update_costbreakdown_fields",c={model_id:a};$.ajax({type:"post",url:b,data:c,success:function(a){var b=(JSON.parse(a),0),c=0;$("#cost-breakdown-table").find(".estimated-subtotal").each(function(){var a=$(this).val();b+=parseFloat(a)}),$("#cost-breakdown-table").find(".subtotal").each(function(){var a=$(this).val();c+=parseFloat(a)});var d=Math.abs(c-b);$(".cost-breakdown-table-class").find("#estimated_cost_breakdown_total").val(b.toFixed(2)),$(".cost-breakdown-table-class").find("#actual_cost_breakdown_total").val(c.toFixed(2)),$(".cost-breakdown-table-class").find("#cost_breakdown_variation").val(d.toFixed(2))}})}}function numberEffects(){$(document).on("keydown",".decimal-only",function(){1==event.shiftKey&&event.preventDefault(),event.keyCode>=48&&event.keyCode<=57||event.keyCode>=96&&event.keyCode<=105||8==event.keyCode||9==event.keyCode||37==event.keyCode||39==event.keyCode||46==event.keyCode||190==event.keyCode||event.preventDefault(),-1!==$(this).val().indexOf(".")&&190==event.keyCode&&event.preventDefault()}),$(document).on("keydown",".less-hundred",function(){var a=parseFloat($(this).val()),b=Math.abs(a-100);console.log(b);var c=a+b;return a>99.99&&8!=event.keyCode?($(this).val(100),!1):c>100&&8!=event.keyCode?!1:void 0}),actualCostBreakDown(),estimatedCostBreakDown(),costVariationBreakdown()}function actualCostBreakDown(){$(document).on("keyup",".auto-calc",function(){var a,b,c,d,e=0;$(this).hasClass("unit-cost")?(a=$(this).val(),b=$(this).closest(".cost-breakdown-row").find(".volume").val()):(b=$(this).val(),a=$(this).closest(".cost-breakdown-row").find(".unit-cost").val()),c=$(this).closest(".cost-breakdown-row").find(".subtotal"),""!=b&&""!=a?(d=parseFloat(b)*parseFloat(a),c.val(d.toFixed(2))):c.val(0),$(this).closest(".cost-breakdown-table-class").find(".subtotal").each(function(){var a=$(this).val();""!=a&&(e+=parseFloat(a))}),$(this).closest(".cost-breakdown-table-class").find("#actual_cost_breakdown_total").val(e.toFixed(2))})}function estimatedCostBreakDown(){$(document).on("keyup",".auto-calc-estimate",function(){var a,b,c,d,e=0;$(this).hasClass("estimated-unit-cost")?(a=$(this).val(),b=$(this).closest(".cost-breakdown-row").find(".estimated-volume").val()):(b=$(this).val(),a=$(this).closest(".cost-breakdown-row").find(".estimated-unit-cost").val()),c=$(this).closest(".cost-breakdown-row").find(".estimated-subtotal"),""!=b&&""!=a?(d=parseFloat(b)*parseFloat(a),c.val(d.toFixed(2))):c.val(0),$(this).closest(".cost-breakdown-table-class").find(".estimated-subtotal").each(function(){var a=$(this).val();""!=a&&(e+=parseFloat(a))}),$(this).closest(".cost-breakdown-table-class").find("#estimated_cost_breakdown_total").val(e.toFixed(2))})}function costVariationBreakdown(){var a,b;$(document).on("keyup",".auto-calc-estimate",function(){a=$(this).closest(".cost-breakdown-table-class").find("#estimated_cost_breakdown_total").val(),b=$(this).closest(".cost-breakdown-table-class").find("#actual_cost_breakdown_total").val(),a=parseFloat(a),b=parseFloat(b);var c=Math.abs(a-b);isNaN(c)&&(c=0),$(".cost-breakdown-table-class").find("#cost_breakdown_variation").val(c.toFixed(2))}),$(document).on("keyup",".auto-calc",function(){b=$(this).closest(".cost-breakdown-table-class").find("#actual_cost_breakdown_total").val(),a=$(this).closest(".cost-breakdown-table-class").find("#estimated_cost_breakdown_total").val(),a=parseFloat(a),b=parseFloat(b);var c=Math.abs(a-b);isNaN(c)&&(c=0),$(".cost-breakdown-table-class").find("#cost_breakdown_variation").val(c.toFixed(2))})}function hide_plus_minus_button(){$(".hide-plus-minus-buttons").find(".row-options-container").hide()}function delete_file_row(){$(document).on("click",".btn-delete-file",function(){var a=".file-row",b="document",c="unlink-file",d="file";if($delete_button=$(this),$file_row=$(this).closest(a),$(a).length>1){$file_row.remove(),file_name=$file_row.find(".fileinput-filename").text(),file_container_id=$file_row.attr("id"),file_id=file_container_id.split("-").pop();var e=b+"/"+c,f={id:file_id,table:d,file_name:file_name},g=base_url+e;$.ajax({type:"POST",url:g,data:f,dataType:"html",success:function(){}})}})}function organisation_role(){$(document).on("change",".role-form-group .role-select",function(a){var b=$(this),c=this.options[a.target.selectedIndex].text;"Other"==c&&(b.addClass("hidden"),b.next(".organisation-other").removeClass("hidden"))}),$(".backtoselect").click(function(){var a=$(this).closest(".role-form-group");a.find(".role-select").val(null),a.find(".organisation-other").addClass("hidden"),a.find(".role-select").removeClass("hidden")})}function checkIfSaved(){$("a").not('.nexttab, .btn-upload-modal, .img-lightbox, .lb-close, .lb-next, .lb-prev, .dropdown, .nav-dropdown, .dropdown-toggle, .dropdown-link, a[data-rel=collapse], .btn-editor, a[data-wysihtml5-command="formatBlock"], .navbar-sidebar-toggle').click(function(a){console.log($(this).attr("class"));var b,c,d=$(this).attr("href");return"window.print();"==d?(a.preventDefault(),void window.print()):($(this).hasClass("fileinput-exists"),$("input[name=link_to]").val(d),void($("form.check-submit").length>0&&(b=$("form.check-submit"),c=b.attr("action"),a.preventDefault(),$("#submit-check-modal ").modal(),$("#submit-check-modal .go-link").on("click",function(){$(this).closest(".modal").modal("hide")}),$("#submit-check-modal .submit").on("click",function(){window.location=d}))))})}function goToByScroll(a){a=a.replace("link",""),$(window).scrollTop($("#"+a).offset().top)}function determineTextareaEditor(a){var b=".textarea-editor.xs";return xxs=a.is(".textarea-editor.xxs"),extra_small=a.is(".textarea-editor.xs"),small=a.is(".textarea-editor.small"),medium=a.is(".textarea-editor.medium"),large=a.is(".textarea-editor.large"),extra_large=a.is("textarea-editor.extra-large"),extra_larger=a.is("textarea-editor.extra-larger"),extra_small?b=".textarea-editor.xs":xxs?b=".textarea-editor.xxs":small?b=".textarea-editor.small":medium?b=".textarea-editor.medium":large?b=".textarea-editor.large":extra_large?b=".textarea-editor.extra-large":extra_larger&&(b=".textarea-editor.extra-larger"),b}function determineEditorHeight(a){var b=50,c=a.is(".textarea-editor.xxs"),d=a.is(".textarea-editor.xs"),e=a.is(".textarea-editor.small"),f=a.is(".textarea-editor.medium"),g=a.is(".textarea-editor.large"),h=a.is("textarea-editor.extra-large"),i=a.is("textarea-editor.extra-larger");return d?b=80:c?b=20:e?b=135:f?b=185:g?b=500:h?b=1e3:i&&(b=2e3),b}function validateSteps(){$(".check-submit.check-completed").bootstrapValidator(required_field_properties)}function validateRequiredInput(a){{var b='<small data-bv-validator="notEmpty" class="text-danger appended"></small>',c=!1,d=!1,e=a.find(".required"),f=(e.length,a.find(".form-group-required .note-editable"));f.length}return e.first().attr("id","first-required"),f.first().attr("id","first-required"),e.length>0?e.each(function(){var a=$(this),d=a.val();if(""==d){{a.attr("id")}return e.addClass("border-red"),e.parent().find(".appended").remove(),e.parent().append(b),!1}c=!0}):c=!0,f.length>0?f.each(function(){var a=$(this),c=a.html();return"<p><br></p>"==c||""==c?(f.addClass("border-red"),f.closest(".form-group").find(".appended").remove(),f.closest(".form-group").append(b),!1):void(d=!0)}):d=!0,c&&d?!0:void 0}function delete_specific_row_action_tracker(){$(document).on("click",".delete-row-action-tracker",function(a){a.preventDefault();{var b=$("#action-tracker-ajax"),c=$(this).closest(".data-row"),d=c.find(".action-tracker-id").text(),e=$("#confirm-delete-form"),f=e.find(".go-yes"),g=e.find(".go-no");$(this)}e.modal(),g.on("click",function(){$(this).closest(".modal").modal("hide")}),f.on("click",function(){e.modal("hide");var a=$("input[name=current_user_id]").val(),f="action_tracker/delete_action_tracker",g=base_url+f,h={current_user_id:a,action_tracker_id:d};$.ajax({type:"post",url:g,data:h,success:function(){c.fadeOut(300,function(){$(this).remove()});var a=b.find("tr.subaction-data-row");$.each(a,function(){var a=$(this).find("p.action-tracker-id").text();parseInt(a)==d&&$(this).fadeOut(300,function(){$(this).remove()})}),b.find(".data-row").length<2&&($(".remove-action-tracker-row").addClass("hidden"),$(".add-action-tracker-row").addClass("hidden"),get_action_tracker_list())}})})}),$(document).on("click",".delete-row-subaction-tracker",function(a){a.preventDefault();{var b=($("#action-tracker-ajax"),$(this).closest(".subaction-data-row")),c=b.find(".subaction-tracker-id").text(),d=$("#confirm-delete-form"),e=d.find(".go-yes"),f=d.find(".go-no");$(this)}d.modal(),f.on("click",function(){$(this).closest(".modal").modal("hide")}),e.on("click",function(){d.modal("hide");var a=$("input[name=current_user_id]").val(),e="action_tracker/delete_subaction_tracker",f=base_url+e,g={current_user_id:a,subaction_tracker_id:c};$.ajax({type:"post",url:f,data:g,success:function(){b.fadeOut(300,function(){$(this).remove()})}})})})}function delete_ajax(a,b,c,d){var e=c.closest("#data-row-"+b),f={id:b};e.fadeOut(500),$.ajax({type:"POST",url:a,data:f,dataType:"html",success:function(){},error:function(){}}),d.closest(".modal").modal("hide")}function confirmDelete(){var a=($("a.delete-form"),$("#confirm-delete-form")),b=a.find(".go-yes"),c=a.find(".go-no");$(document).on("click","a.delete-form",function(d){var e=$(this),f=$(this).attr("href"),g=f.split("/"),h=g.length,i=g[h-1];d.preventDefault(),a.modal(),c.on("click",function(){$(this).closest(".modal").modal("hide")}),b.on("click",function(){delete_ajax(f,i,e,$(this))})})}function ajax_select(a,b,c,d,e,f,g){var e=e||null,f=f||"menu",g=g||"code",h=$(d);$(a).length>0&&$(document).on("change",a,function(){var a=$(this),i=a.val(),j={id:i,menu_type:c,menu_level:f,menu_detail:g},k=base_url+b;$.ajax({type:"POST",url:k,data:j,dataType:"html",success:function(b){'<option value="" class="bg-white">- Select -</option>'==b||'<option value="" class="bg-white">- Select from Main Category -</option>'==b?(h.closest(".equipment-select").slideUp(),h.closest(".equipment-select").next(".equipment-select").slideUp()):h.closest(".equipment-select").slideDown(),null==e?$(d).is("input")?h.val(b):h.html(b):(h=a.closest(e).find(d),$(d).is("input")?h.val(b):h.html(b))}})})}function document_status(){var a=($("#document_status"),$("#reviewed-by-row")),b=$("#approved-by-row");$(document).on("change","select[name=document_status]",function(){var c=$(this),d=(c.val(),c.find("option:selected").text()),e=$("input[name=document_status_value]");e.val(d.toLowerCase()),"Reviewed"==d?(a.removeClass("hidden"),b.addClass("hidden")):-1!=d.indexOf("Approved")?(a.addClass("hidden"),b.removeClass("hidden")):(a.addClass("hidden"),b.addClass("hidden"))}),$(document).on("click","#update-document-status",function(a){a.preventDefault();var b=$(this),c=$(this).closest("form").serializeArray(),d={};$(c).each(function(a,b){d[b.name]=b.value});var e=d.document_status_submit;b.button("loading"),b.text("Updating..."),$.ajax({type:"POST",url:e,data:c,dataType:"html",success:function(){user_document_status()}}).always(function(){b.addClass("btn-success"),b.button("reset"),b.removeClass("btn-success")})}),$(document).on("click","#update-document-status-window",function(a){a.preventDefault();var b=$(this),c=b.closest("tr").find("select[name=document_status]").val(),d=b.closest("tr").attr("id").split("-").pop(),e=$(this).closest("form").serializeArray(),f={};f.update_document_status=c,f.update_document_id=d,f.from_status_window=!0,$(e).each(function(a,b){f[b.name]=b.value});var g=f.document_status_submit;b.button("loading"),b.text("Updating..."),$.ajax({type:"POST",url:g,data:f,dataType:"html",success:function(){}}).always(function(){b.addClass("btn-success"),b.button("reset"),b.removeClass("btn-success")})})}function user_document_status(){var a=$("#document-status-history").find("tbody"),b=$("input[name=model_id]").val(),c="document/get_user_document_status",d=base_url+c,e={document_id:b};$.ajax({type:"post",url:d,data:e,dataType:"json",success:function(b){var c="";b.length<1?$("#document-status-history").parents("#document-status-container").hide():($("#document-status-history").parents("#document-status-container").show(),$.each(b,function(a,b){c+="<tr>",c+="<td>",c+=b.fullname,c+="</td>",c+="<td>",c+=b.status,c+="</td>",c+="<td>",c+=b.date,c+="</td>",c+="</tr>"}),a.html(c))}})}function navbarToggle(){$(document).on("click",".navbar-sidebar-toggle",function(){var a="user/navbar_toggle",b=base_url+a,c="",d="sidebar-condensed";c=$("body").hasClass(d)?d:"",$.ajax({type:"post",url:b,data:{sidebar_state:c},dataType:"html",success:function(a){console.log(a)},error:function(a){console.log(a)}})})}function editUserProfile(){var a=$("#user-info-panel"),b=$("a.edit-user-information"),c=$("#user-info-panel").find(".cancel-button"),d=$("#user-info-panel").find(".save-button");b.on("click",function(){a.find(".view-user-info").addClass("hidden"),a.find(".edit-user-info").fadeIn().removeClass("hidden"),a.find("#save-user-info").removeClass("hidden")}),c.on("click",function(){a.find(".view-user-info").fadeIn().removeClass("hidden"),a.find(".edit-user-info").addClass("hidden"),a.find("#save-user-info").addClass("hidden")}),d.on("click",function(){a.find(".save-animation").removeClass("hidden");var b="user/save_information",c=base_url+b;$position_text=a.find("#user-position-value"),$discipline_text=a.find("#user-discipline-value"),$years_of_service_text=a.find("#user-years-of-service-value"),$area_of_operation_text=a.find("#user-area-of-operation-value"),$highest_qualification_text=a.find("#user-highest-qualification-value"),$email_address_text=a.find("#user-email-address-value"),$position_select=a.find("select[name=position]"),$discipline_select=a.find("select[name=discipline]"),$area_of_operation_select=a.find("select[name=area_of_operation]"),$years_of_service_select=a.find("select[name=years_of_service]"),$highest_qualification_select=a.find("select[name=highest_qualification]"),$email_address_input=a.find("input[name=email_address]"),$original_email_address_input=a.find("input[name=original_email_address]"),$confirm_email_input=a.find("input[name=confirm_email_address]");var d=$position_select.val(),e=$discipline_select.val(),f=$area_of_operation_select.val(),g=$years_of_service_select.val(),h=$highest_qualification_select.val(),i=$email_address_input.val(),j=$original_email_address_input.val(),k=$confirm_email_input.val(),l=$position_select.find("option:selected").text(),m=$discipline_select.find("option:selected").text(),n=$area_of_operation_select.find("option:selected").text(),o=$years_of_service_select.find("option:selected").text(),p=$highest_qualification_select.find("option:selected").text(),q={position:d,discipline:e,area_of_operation:f,years_of_service:g,highest_qualification:h,original_email_address:j,email_address:i,confirm_email_address:k,password:null};console.log(q),$.ajax({type:"post",url:c,data:q,dataType:"json",success:function(b){var c=b.result,d=b.error_text,e=a.find("#my-account-error");"fail"==c?($email_address_input.addClass("border-red"),$confirm_email_input.addClass("border-red"),a.find(".save-animation").addClass("hidden"),e.text(d),e.removeClass("hidden")):($email_address_input.removeClass("border-red"),$confirm_email_input.removeClass("border-red"),e.addClass("hidden"),$position_text.text(l),$discipline_text.text(m),$area_of_operation_text.text(n),$years_of_service_text.text(o),$highest_qualification_text.text(p),$email_address_text.text(i),$original_email_address_input.val(i),a.find(".save-animation").addClass("hidden"),a.find(".view-user-info").fadeIn().removeClass("hidden"),a.find(".edit-user-info").addClass("hidden"),a.find("#save-user-info").addClass("hidden"))},error:function(a){console.log(a)}})})}function editLessonsToBeLearned(){var a=$("#notifications-and-preferences");$(".panel-body").find('input[name="case_file_checkbox"]').on("switchChange.bootstrapSwitch",function(b,c){var d="user/update_user_notification",e=base_url+d,f=c,g={state:f,column:"notify_case_file"};1==a.find(".save-animation").hasClass("hidden")&&a.find(".save-animation").removeClass("hidden"),0==a.find(".text-success").hasClass("hidden")&&a.find(".text-success").addClass("hidden"),$.ajax({type:"post",url:e,data:g,dataType:"html",success:function(){0==a.find(".save-animation").hasClass("hidden")&&setTimeout(function(){a.find(".save-animation").addClass("hidden"),a.find(".text-success").fadeIn("slow"),a.find(".text-success").removeClass("hidden"),a.find(".text-success").delay(500).fadeOut("slow")},500)},error:function(a){console.log(a)}})}),$(".panel-body").find('input[name="tb_checkbox"]').on("switchChange.bootstrapSwitch",function(b,c){var d="user/update_user_notification",e=base_url+d,f=c,g={state:f,column:"notify_technical_bulletin"};1==a.find(".save-animation").hasClass("hidden")&&a.find(".save-animation").removeClass("hidden"),0==a.find(".text-success").hasClass("hidden")&&a.find(".text-success").addClass("hidden"),$.ajax({type:"post",url:e,data:g,dataType:"html",success:function(){0==a.find(".save-animation").hasClass("hidden")&&setTimeout(function(){a.find(".save-animation").addClass("hidden"),a.find(".text-success").fadeIn("slow"),a.find(".text-success").removeClass("hidden"),a.find(".text-success").delay(500).fadeOut("slow")},500)},error:function(a){console.log(a)}})}),$(".panel-body").find("input.equipment-category-box").on("ifToggled",function(){var b=$(this).closest("label"),c=(b.text(),$(this).prop("checked")),d=0;1==c&&(d=1);var e=b.find("input.equipment-category-id").val(),f="user/update_single_user_preference",g=base_url+f,h={menu_id:e,notify:d};1==a.find(".save-animation").hasClass("hidden")&&a.find(".save-animation").removeClass("hidden"),0==a.find(".text-success").hasClass("hidden")&&a.find(".text-success").addClass("hidden"),$.ajax({type:"post",url:g,data:h,dataType:"html",success:function(){0==a.find(".save-animation").hasClass("hidden")&&setTimeout(function(){a.find(".save-animation").addClass("hidden"),a.find(".text-success").fadeIn("slow"),a.find(".text-success").removeClass("hidden"),a.find(".text-success").delay(500).fadeOut("slow")},500)},error:function(a){console.log(a)}})})}function addRemoveFollowUser(){var a=$("#my-account-follow-users"),b=a.find("span.glyphicon-plus");b.on("click",function(){var b=a.find(".hidden-clone").clone();b.removeClass("hidden"),b.removeClass("hidden-clone"),b.addClass("input-group"),b.find("select").addClass("select2-dropdown"),b.insertBefore(a.find(".add-remove-buttons")),selectEffects()})}function changePhoto(){var a=$("a.change-user-photo"),b=$("#change-photo");a.on("click",function(){b.modal()})}function fixSizeAddRemoveFollowUser(){var a=$("#my-account-follow-users"),b=a.find("div.add-remove-buttons").width(),c=a.width()-b;a.find(".new-user").width(c)}function addRemoveFollowUser(){function a(){var a=d.find("select.new-user");a.each(function(){f.push(this.value)}),console.log(f)}function b(){$select_value=d.find("select.new-user"),$select_value.on("select2-open",function(){console.log($(this).val()),c=$(this).val()}),$select_value.on("change",function(){var a=1,b=$(this).closest("div.input-group"),d=b.find("input[name=follow_user]").val(),e=$(this).val(),g=$(this);fixSizeAddRemoveFollowUser();var h=$('input[name="current_user_id"]').val();e==h&&($(this).select2("val",c),a=0);for(var i=0;i<f.length;i++)if(f[i]==e){$(this).select2("val",c),a=0;break}if(1==a){var j=e,k="user/update_single_follow_user",l=base_url+k,m={followed_id:j,follow_user_id:d};$.ajax({type:"post",url:l,data:m,dataType:"html",success:function(a){{var b=g.closest("div.input-group");b.find("input[name=follow_user]").val(a)}},error:function(a){console.log(a)}})}})}var c,d=$("#my-account-follow-users"),e=d.find("a.add-follower"),f=[];$(document).on("click","button.remove-user-button",function(){var a=$(this).closest("div.input-group"),b=a.find("input[name=follow_user]").val(),c=$(this),d="user/delete_single_follow_user",e=base_url+d,f={follow_user_id:b};$.ajax({type:"post",url:e,data:f,dataType:"html",success:function(){c.closest("div.input-group").remove()},error:function(a){console.log(a)}})}),a(),b(),e.on("click",function(){var c,e=d.find("div.input-group:nth-last-child(2)");if(c=0==e.length?"1":e.find("select").val(),console.log(c),console.log(e.length),""==c||"0"==c||null==c||" "==c);else{var g=d.find(".hidden-clone").clone();g.removeClass("hidden"),g.removeClass("hidden-clone"),g.addClass("input-group"),g.find("select").addClass("select2-dropdown"),g.insertBefore(d.find(".add-remove-buttons")),selectEffects(),f=[],a(),b(),fixSizeAddRemoveFollowUser()}})}function userHistoryOfAvailability(a,b,c,d,e,f,g){var h=$("#history-of-availability-table"),i=(h.find("table"),$(".create-criticality-analysis"));if(h.length>0){var j=h.find("tbody"),k=$("#loading-criticality-analysis"),l=$("#no-criticality-analysis"),m=$("#no-search-found"),n=$("input[name=current_user_id]").val(),a=a||null,b=b||null,c=c||null,d=d||null,e=e||null,f=f||null,g=g||!1,o="criticality-analysis/get_criticality_analysis",p=base_url+o,q={current_user_id:n,asset:a,category:b,code:c,last_review_date:d,category_list:e,owner_id:f};g||(k.removeClass("hidden"),h.hide(),m.addClass("hidden"),l.addClass("hidden")),$.ajax({type:"post",url:p,data:q,dataType:"json",success:function(b){var c=[],d=b.table_data,e=(b.table_info,b.user_info),f=(e.user_id,e.asset_role),n=(e.asset,e.site_role);if(g){var o=new Date;$.each(d,function(a,b){c[a]={ASSET:b.asset,"TAG NUMBER":b.tag_number,DESCRIPTION:b.description,REDUNDANCY:b.reliability_redundancy_value,SAFETY:b.safety_health_criticality_value,ENVIRONMENT:b.environmental_criticality_value,OPERATION:b.operational_criticality_value,REINSTATEMENT:b.reinstatement_value,CAS:b.cas,FREQUENCY:b.frequency_value}}),JSONtoCSV(c,"criticality_analysis_"+o,!0)}else{"superuser"!=f&&$("th.action").remove(),"siteadmin"!=n&&i.remove();d.length<1?(k.addClass("hidden"),h.hide(),null!=a?m.removeClass("hidden"):l.removeClass("hidden")):(k.addClass("hidden"),h.show(),$.each(d,function(a,b){var c="";c+="<tr>",c+="<td>"+b.asset+"</td>",c+="<td>"+b.tag_number+"</td>",c+="<td>"+b.description+"</td>",c+='<td class="'+b.arn_color+'">'+b.available_right_now+"</td>",c+='<td class="'+b.alert_color+'">'+b.alert+"</td>";var d=b.availability_info;$.each(d,function(a,b){var d=b.availability_percentage,e=b.availability_record,f=b.availability_record_color,g=b.percentage_color;c+='<td class="'+g+'">'+d+"</td>",c+='<td class="'+f+'">'+e+"</td>"}),c+="</tr>",j.append(c)}))}tableReflow()}})}}function scrollbar(a,b){var c=a.width(),d=b.width();if(d>c){var e='<span id="panLeft" class="panner" data-scroll-modifier="-1">Left</span>',f='<span id="panRight" class="panner" data-scroll-modifier="1">Right</span>';a.append(e),a.append(f),function(){function b(a){0===d&&(d=setInterval(function(){var b=f.scrollLeft()+e*a;f.scrollLeft(b)},10))}function c(){clearInterval(d),d=0}var d=0,e=5,f=a;$(".panner").on("mouseenter",function(){var a=$(this).data("scrollModifier"),c=parseInt(a,10);$(this).addClass("active"),b(c,e)}),$(".panner").on("mouseleave",function(){c(),$(this).removeClass("active")})}()}}function tooltipsAndPopovers(){$(".highway-code-popover").clickover({global_close:!0,trigger:"click",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>The Highway Code are our Golden Rules for working in the site. Please look at these on a regular basis.</p>"}),$(".enablers-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p><h4>Prerequisites</h4> Describe any fundamental aspects which must be in place at the start of the project and which must remain in place for the project to succeed</p><p><h4>Dependencies</h4> A description of any specialist help such as scaffolding, tools, access, isolations, etc. that the progress and success of the project depends on</p>"}),$(".risks-and-threats-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Identify and list the risks and potential threats that should be considered and potential mitigating actions that could be introduced to reduce these when implementing this solution</p>"}),$(".constraints-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>List any bottlenecks or process gaps that may require special attention or temporary measures to ensure this does not affect progress</p>"}),$(".basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Please take the time to complete the profile in detail. This is a reflection of your professionalism and commitment to attaining and sustaining excellence in your workplace Once completed it will enable you and others to share and learn from your experience If you want to save and return later simply click save at the bottom of the page</p><p>If you want to attach any media or documents please save them as a PDF if possible and remember to take the opportunity to label them and any photos accurately, highlight areas of specific interest with arrows, descriptions, etc.</p><p>It is important to document all the activities involved in dealing with this particular issue and sharing the results in order for others to benefit fully.</p><p>This will be rated by others and you should be able to point to this submission with a level of satisfaction and pride in future when involved in either personal appraisals or when discussing promotion.</p>"}),$(".step1-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Please describe the equipment or issue in details on others can appreciate the history of it. </p> <p>Note:</p> <ul> <li>If appropriate explain the limits of operation, make, model, age and history</li> <li>Was it maintained correctly, was it problematic, was maintenance recently carried out by vendors or by crew.</li> <li>If this is a system or process issues explain why it is required and what is the purpose of it.</li> </ul>"}),$(".timeline-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Please provide a brief summary of the events leading to the event, including names of personnel who may provide clarification later</p>"}),$(".method-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> This is the method or activity by which a failure is discovered. This information is vitally important when evaluating the effect of maintenance, e.g. to distinguish between failures discovered by a planned action or by chance. </p>"}),$(".failure-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> The ‘Failure Mode’ is a more detailed description of the trigger/failing that was discovered after the Method of Detection determined further investigation was required. </p>"}),$(".mechanism-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> The failure mechanism is the physical, chemical or other process or combination of processes that leads to the failure. It is an attribute of the failure event that can be deduced technically, e.g. the apparent, observed cause of the failure. </p>"}),$(".factor-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>The 5 Whys is the simplest of RCA tools to use and essentially consists of asking the question ‘why?’ until the root cause is found or there is no further benefit in asking why?</p>"}),$(".conclusion-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Clearly define the root or probable cause, if there are multiple causes then please list them also </p> "}),$(".cause-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:'<p> The objective of these data is to identify the initiating event "root cause" in the sequence leading up to a failure of an equipment item. </p>'}),$(".step4-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Note: </p> <ul> <li>Identify the benefits</li> <li>Estimate the savings, cost of implementation and testing</li> <li>Identify if there are risks involved, what suitable mitigation can be employed</li> <li>Detail who need to do what, include a RACI chart if required</li> <li>Identify the next steps</li> </ul>"}),$(".improvement-basic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>What does the work scope consist of, for example;</p> <ul> <li>List the physical changes to equipment</li> <li>Changes to the surrounding areas</li> <li>Changes to the CMMS</li> <li>Changes to Operation</li> </ul>"}),$(".step-process-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Note: </p> <ul> <li>A solution is not a solution until you have proven it resolves the problem or improves the situation</li> <li>Describe a suitable test process with baselines if possible, frequency, units of measurements, etc,.</li> <li>The improvement must be provide tangible results to be considered successful</li> <li>If there are routine inspections / test consider using the CMMS to schedule and allocate these</li> </ul>"}),$(".evaluate-results-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Detail the results of the test process and clearly state if this has been an improvement and the next steps. </p> <p> Note: </p> <ul> <li>If these are positive you can start the process to close this issue out.</li> <li>If you have received negative results then either intensify focus, try something different, escalate to technical authority or involve vendors or specialists.</li> <li>Please summarise what happened after the improvement was performed</li> </ul>"}),$(".recommendations-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> This is the final step, please provide lessons learned and recommendations you would like to share with others relating to your experience with this problem. </p> <p> Note: </p> <ul> <li>Sharing negative results can be as valuable as positive results</li> <li>You may be able to save somebody considerable expense and time attempting a solution you know will not work</li> <li>This is an example of a professionalism, print a copy so you and a colleague can proof read it prior to sharing</li> </ul>"}),$(".forensic-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:'<p> Please take the time to complete the profile in detail. This is a reflection of your professionalism and commitment to attaining and sustaining excellence in your workplace. Once completed it will enable you and others to share and learn from your experience. If you want to save and return later, simply click "save" at the bottom of the page. </p> <p> If you want to attach any media or documents please save them as a PDF if possible and remember to take the opportunity to label them and any photos accurately, highlight areas of specific interest with arrows, descriptions, etc. </p> <p> It is important to document all the activities involved in dealing with this particular issue and sharing the results in order for others to benefit fully. </p> <p> This will be rated by others and you should be able to point to this submission with a level of satisfaction and pride in future when involved in either personal appraisals or when discussing promotion. </p>'}),$(".step1-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Please describe the equipment or issue in detail so on others can appreciate the history of it. </p> <p>Note:</p> <ul> <li>If appropriate explain the limits of operation, make, model, age and history</li> <li>Was it maintained correctly, was it problematic, was maintenance recently carried out by vendors or by crew.</li> <li>If this is a system or process issue explain why it is required and what is the purpose of it.</li> </ul>"}),$(".step1-timeline-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Please list all the relevant events and dates in order of the occurrence. If the event has been confirmed then select confirmed, however if no evidence is available then select “suspected” If you are in doubt regarding the relevance then list it and select “suspected” Do not leave out events that can be indicative of possible causes.</p>"}),$(".step1-method-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<h3>Method of Detection</h3> <p> This is the method or activity by which a failure is discovered. This information is vitally important when evaluating the effect of maintenance, e.g. to distinguish between failures discovered by a planned action or by chance. </p>"}),$(".step1-failure-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<h3>Failure Mode</h3> <p> The ‘Failure Mode’ is a more detailed description of the trigger/failing that was discovered after the Method of Detection determined further investigation was required. </p>"}),$(".step2-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Before you attempt to complete the section ensure you have received all possible sources of additional input. </p> <p> Now state what the actual problem is and what are the effects of this </p> <p> Note: </p> <p> If there has been an event to trigger this then detail: </p> <ul> <li>What happened</li> <li>When did it happen</li> <li>Where did it happen</li> <li>What is the issue you are trying to resolve, for example</li> <p>This pump must be reinstated without the threat of this failure happening again</p> <p>The reliability of this switch must be improved</p> <p>The protection on this equipment does not prevent damage</p> </ul>"}),$(".step3-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:'<p> A root cause analysis must be performed, use the most appropriate method for the complexity of the problem. Describe below what the RCA methodology was used, key steps and highlight the root cause of the problem, upload any document/photos that have captured the process and findings. List the participants in case there are questions later regarding the process. </p> <p> Note: </p> <ul> <li>Do not work in isolation</li> <li>Do not stop too early</li> <li>There are often multiple events that lead to a single failure, look at all possibilities Consider "Why" did something happen, ask the question five times. (5 why)</li> <li>If despite your best efforts, you have been unable to fully ascertain the root cause but you have established a "probable or likely cause" then progress with what you have just remember to keep an open mind.</li> </ul>'}),$(".step3-failure-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> The failure mechanism is the physical, chemical or other process or combination of processes that leads to the failure. It is an attribute of the failure event that can be deduced technically, e.g. the apparent, observed cause of the failure. </p>"}),$(".step3-failure-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> The failure mechanism is the physical, chemical or other process or combination of processes that leads to the failure. It is an attribute of the failure event that can be deduced technically, e.g. the apparent, observed cause of the failure. </p>"}),$(".step3-contributory-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>The 5 Whys is the simplest of RCA tools to use and essentially consists of asking the question ‘why?’ until the root cause is found or there is no further benefit in asking why?</p>"}),$(".step3-conclusion-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Clearly define the root or probable cause, if there are multiple causes then please list them also </p>"}),$(".step3-case-file-failure-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:'<h3>Failure Cause</h3> <p> The objective of these data is to identify the initiating event "root cause" in the sequence leading up to a failure of an equipment item. </p>'}),$(".pp-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:'<p class="strong">Introduction</p> <p>The template is designed to prompt the Project Leader and help in the creation of the Project Plan. Once your Project Plan is completed check the document against the following Quality Criteria:</p> <ul> <li>Is the plan achievable?</li> <li>Does it support the rest of the Project Initiation Document?</li> </ul>'}),$(".pp-step1-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> This step should be confined to one or two pages at most, use bullet points where possible and keep it brief. The following sections will help you to describe your plan, keep the contents of each section relevant to that specific section and review once you are complete. Allow a colleague to perform a peer review and see if they have any questions </p>"}),$(".pp-ex-sum-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> A brief summary of what the plan is going to achieve, this section provides a statement of how and when a project’s objectives are to be achieved, by highlighting the major outputs, activities and resources required on the project </p>"}),$(".pp-purpose-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Explain why the project needs to be done</p>"}),$(".pp-success-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>What does success look like, use this section to inform those involved in the project how we will determine if the project has been successful</p>"}),$(".pp-location-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Where will this project take place, provide a brief overview of the locations. Remember no surprises, do not assume there is space or hardware available, check first</p>"}),$(".pp-step2-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:" <p>This section should be transparent to management to remind them we the investment is justified. Remember we need to monitor project progress and cost, stage by stage</p>"}),$(".pp-benefits-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:" <p> Identify the area or areas of benefits and provide a brief description summarising all of these collectively </p>"}),$(".pp-risks-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>List the risks and threats that could contribute to this project failing to complete on time or on budget with the original resources, such as excessive lead times, availability of parts, weather, etc</p>"}),$(".pp-costs-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Summary of all relevant costs, inclusive of travel, accommodation, per diem and contingency, if you do not have confirmed costs then estimate until confirmation is recieved</p>"}),$(".pp-step3-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>A brief description of what the plan covers and it’s boundaries</p>"}),$(".pp-boundaries-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Describe what is included and what is not included, there should be no surprises at the end of this project so clearly establish the boundaries </p>"}),$(".pp-enablers-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>This term refers to all activities and requirements needed to allow the project to progress, do not leave things to chance, play safe and list any enablers, real or perceived.</p>"}),$(".pp-prerequisites-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:" <p> The term prerequisite refers to aspects that must be, and must remain in place for the project plan to be achieved such as; </p> <ul> <li>All resources to be available for the duration of the project</li> <li>Work site to remain free of contaminants</li> </ul>"}),$(".pp-dependencies-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:" <p> The term prerequisite refers to aspects that must be, and must remain in place for the project plan to be achieved such as; </p> <ul> <li>Existing pump and motor to be removed</li> <li>Hatch to be cut to allow access</li> <li>Scaffolding to be erected</li> </ul>"}),$(".pp-specialist-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:" <p> This refers to specialist tools, resources and other enablers that are worth highlighting. If you are unsure of the availability then play safe and list it. </p>"}),$(".pp-assumptions-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>List any assumptions being made that will affect the projects progress or success such as deck space and access</p>"}),$(".pp-step4-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>This section includes details of the teams who is in charge and reporting</p>"}),$(".pp-reporting-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>If you require close control then use this option for tracking progress</p>"}),$(".pp-action-tracker-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:'<p><strong>Status Colors:</strong></p><table><tr><td class="bg-green status-legend"> &nbsp; &nbsp;</td><td>&nbsp;-&nbsp;</td><td>Open</td></tr><tr><td class="bg-red status-legend"> &nbsp; &nbsp;</td><td>&nbsp;-&nbsp;</td><td>Closed</td></tr><tr><td class="bg-orange status-legend"> &nbsp; &nbsp;</td><td>&nbsp;-&nbsp;</td><td>Due</td></tr></table>'}),$(".pp-deliverables-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> List the physical outcomes of the project, something that you can read, touch or use when completed. This step is essential in quality control of the commercial aspects of your project and could be key to commercial decisions regarding “did you receive what was asked for </p>"}),$(".pp-expectation-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Clearly define who will provide what, what they need to achieve the output, how they will produce it “the process” and who it will be supplied to </p>"}),$(".pp-step7-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Clearly define the next steps, responsible parties and due dates. Keep it relevant to progress and refrain from allocating actions to more than one person</p>"}),$(".cf-step4-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Note: </p> <ul> <li>Identify the benefits</li> <li>Estimate the savings, cost of implementation and testing</li> <li>Identify if there are risks involved, what suitable mitigation can be employed</li> <li>Detail who need to do what, include a RACI chart if required</li> <li>Identify the next steps</li> </ul>"}),$(".cf-improvement-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>What does the work scope consist of, for example;</p> <ul> <li>List the physical changes to equipment</li> <li>Changes to the surrounding areas</li> <li>Changes to the CMMS</li> <li>Changes to Operation</li> </ul>"}),$(".cf-step5-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Note: </p> <ul> <li>A solution is not a solution until you have proven it resolves the problem or improves the situation</li> <li>Describe a suitable test process with baselines if possible, frequency, units of measurements, etc,.</li> <li>The improvement must be provide tangible results to be considered successful</li> <li>If there are routine inspections / test consider using the CMMS to schedule and allocate these</li> </ul>"}),$(".cf-pass-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Explain what a pass or failure would look like, is a partial improvement acceptable? </p>"}),$(".cf-step6-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Detail the results of the test process and clearly state if this has been an improvement and the next steps. </p> <p> Note: </p> <ul> <li>If these are positive you can start the process to close this issue out.</li> <li>If you have received negative results then either intensify focus, try something different, escalate to technical authority or involve vendors or specialists.</li> <li>Please summarise what happened after the improvement was performed</li> </ul>"}),$(".cf-step7-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> This is the final step, please provide lessons learned and recommendations you would like to share with others relating to your experience with this problem. </p> <p> Note: </p> <ul> <li>Sharing negative results can be as valuable as positive results</li> <li>You may be able to save somebody considerable expense and time attempting a solution you know will not work</li> <li>This is an example of a professionalism, print a copy so you and a colleague can proof read it prior to sharing</li> </ul>"}),$(".cf-detection-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Why was this not detected sooner </p>"}),$(".cf-prevention-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:" <p> What can we do to prevent this happening again </p>"}),$(".cf-recommendations-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:" <p>Please share any recommendations you may have, what went well, what didnt go so well. If you were to do this again what would you do differently. </p>"}),$(".erp-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:' <p> Please take the time to complete the profile in detail. This is a reflection of your professionalism and commitment to attaining and sustaining excellence in your workplace. Once completed it will give you and others visibility of equipment repairs throughout the ‘Repairs Journey’ including; </p> <p> • Communication updates to all interested parties (hereinafter referred to as; ‘users’ within a ‘user group’) as a repair item moves between each stage (end users being those involved or interested in the progress of the repair throughout the ‘Repairs Journey’) </p> <p> • Written reports of equipment by the individual carrying out the repair</p> <p> If you want to save and return later, simply click "save" at the bottom of the page. </p> <p> If you want to attach any media or documents please save them as a PDF if possible and remember to take the opportunity to label them and any photos accurately, highlight areas of specific interest with arrows, descriptions, etc. </p> <p> It is important to document all the activities involved in dealing with this particular equipment repair and sharing the results in order for other users to benefit fully. </p> <p> This will be rated by others and you should be able to point to this submission with a level of satisfaction and pride in future when involved in either personal appraisals or when discussing promotion. </p>'}),$(".erp-step3-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> Please describe the equipment or issue in details on others can appreciate the history of it. </p> <p>Note:</p> <ul> <li>If appropriate explain the limits of operation, make, model, age and history</li> <li>Was it maintained correctly, was it problematic, was maintenance recently carried out by vendors or by crew.</li> <li>If this is a system or process issues explain why it is required and what is the purpose of it.</li> </ul>"}),$(".erp-scope-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Please summarize the scope of work involved in this repair.</p>"}),$(".erp-deliverables-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Please summarize the scope of work involved in this repair.</p>"}),$(".erp-quality-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Think about what measures need to be taken, do not leave quality issues to chance, ensure any risks relating to quality of workmanship are dealt with</p>"}),$(".erp-pass-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Explain what a pass or failure would look like, is a partial improvement acceptable? </p>"}),$(".erp-step4-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p> This is the final step, please provide lessons learned and recommendations you would like to share with others relating to your experience with this problem. </p> <p> Note: </p> <ul> <li>Sharing negative results can be as valuable as positive results</li> <li>You may be able to save somebody considerable expense and time attempting a solution you know will not work</li> <li>This is an example of a professionalism, print a copy so you and a colleague can proof read it prior to sharing</li> </ul>"}),$(".erp-findings-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Describe what you found, these are fact based and should include failure, root cause and solution</p>"}),$(".erp-summary-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Describe the approach you took to the investigation (shore based or offshore, thorough investigation or restricted due to lack of access or operational issues.) Also describe the implementation of the solution and test.</p>"}),$(".erp-recommendations-popover").clickover({global_close:!0,trigger:"click focus",placement:"right",container:"body",html:!0,title:'&nbsp; <button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button>',template:'<div class="popover popover-default" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>',content:"<p>Please share any recommendations you may have, what went well, what didnt go so well. If you were to do this again what would you do differently. </p>"}),$(".add-subaction-tracker").tooltip("destroy"),$(".add-subaction-tracker").tooltip({trigger:"hover",placement:"left",html:!0,title:"Add a subaction"}),$(".create-action").popover("destroy"),$(".create-action").popover({trigger:"hover",placement:"bottom",delay:{show:500,hide:100},html:!0,content:'<div id="">Add a related action</div>'}),$("button.add-action-tracker-row").tooltip("destroy"),$("button.add-action-tracker-row").tooltip({trigger:"hover",placement:"left",html:!0,title:"Add a blank action"}),$(".delete-row-action-tracker, .delete-row-subaction-tracker").tooltip("destroy"),$(".delete-row-action-tracker, .delete-row-subaction-tracker").tooltip({trigger:"hover",placement:"top",html:!0,title:"Delete this action"}),$(".show-files-action-tracker, .show-files-subaction-tracker").tooltip("destroy"),$(".show-files-action-tracker, .show-files-subaction-tracker").tooltip({trigger:"hover",placement:"top",container:"body",html:!0,title:"View Image/s"}),$(".attach-action-tracker, .attach-subaction-tracker").tooltip("destroy"),$(".attach-action-tracker, .attach-subaction-tracker").tooltip({trigger:"hover",placement:"top",container:"body",html:!0,title:"Attach files"}),$(".edit-action-tracker, .edit-subaction-tracker").tooltip("destroy"),$(".edit-action-tracker, .edit-subaction-tracker").tooltip({trigger:"hover",placement:"top",container:"body",html:!0,title:"Save Action"}),$(".show-hide-mini-tooltip").popover("destroy"),$(".show-hide-mini-tooltip").popover({trigger:"hover",placement:"top",delay:{show:500,hide:100},html:!0,content:'<div id="">Show/Hide more equipment details</div>'}),$(".status-mini-tooltip").popover("destroy"),$(".status-mini-tooltip").clickover({global_close:!0,trigger:"click focus",placement:"bottom",title:'<div class="text-center" id="status-popover"><strong>Status</strong><button type="button" class="close" data-dismiss="clickover"><span aria-hidden="true">&times;</span></button></div>',html:!0,content:'<div class="row"><div class="col-sm-1"><i class="fa fa-check"></i></div><div class="col-sm-1"> - </div><div class="col-sm-6 bg-green">OK</div></div><div class="row"><div class="col-sm-1"><i class="fa fa-question"></i></div><div class="col-sm-1"> - </div><div class="col-sm-6 bg-yellow">Alert</div></div><div class="row"><div class="col-sm-1"><i class="fa fa-exclamation"></i></div><div class="col-sm-1"> - </div><div class="col-sm-6 bg-orange">Warning</div></div><div class="row"><div class="col-sm-1"><i class="fa fa-times"></i></div><div class="col-sm-1"> - </div><div class="col-sm-6 bg-red">Critical</div></div><div class="row"><div class="col-sm-1"><i class="fa fa-times-circle"></i></div><div class="col-sm-1"> - </div><div class="col-sm-6 bg-dark-red">Fail</div></div><div class="row"><div class="col-sm-1"><i class="fa fa-question-circle"></i></div><div class="col-sm-1"> - </div><div class="col-sm-6 bg-dark-green">In Prog</div></div>'})
}function defaultRowWriter(a,b,c,d){for(var e="",f=0,g=c.length;g>f;f++)e+=d(c[f],b);return'<tr id="data-row-'+b.document_id+'">'+e+"</tr>"}function getDataTable(a,b,c){var d=!0,c=c||"",e=b+"/get-user-form",f=base_url+e,g={to_json:d,table_document_code:c};$.ajax({type:"post",url:f,data:g,dataType:"json",success:function(b){$("#"+a).dynatable({dataset:{records:b,perPageDefault:5,perPageOptions:[5,10,20,30]},inputs:{paginationClass:"pagination pagination-sm pull-right",paginationLinkClass:"dynatable-page-link",paginationPrevClass:"dynatable-page-prev",paginationNextClass:"dynatable-page-next",paginationActiveClass:"dynatable-active-page",paginationDisabledClass:"dynatable-disabled-page",paginationPrev:"Previous",paginationNext:"Next",recordCountTemplate:'<div id="dynatable-record-count-{elementId}" class="dynatable-record-count">{textTemplate}</div>'},writers:{_rowWriter:defaultRowWriter}})}})}function getUserData(){var a="user/get_user",b=base_url+a;$.ajax({type:"post",url:b,dataType:"json",success:function(a){var b=a.table_data;$(b).each(function(){})}})}function bootstrapEffects(){$("input.boot-switch").bootstrapSwitch(),dateEffects()}function dateEffects(){$("[data-rel=datepicker], .datepicker").datepicker({format:"dd/mm/yyyy",orientation:"auto left"}).on("changeDate",function(){$(this).datepicker("hide")}),$(".datepicker-action-tracker").datepicker({format:"d/m/yy",orientation:"auto left"}).on("changeDate",function(){$(this).datepicker("hide")}),$("[data-rel=timepicker],.timepicker").timepicker()}function selectEffects(){$("select.form-select2, select.select2-dropdown").select2()}function tableEffects(){$(".sticky-thead").floatThead()}function tableReflow(){$(".sticky-thead").floatThead("reflow")}function inputEffects(){$("input.icheck[type=radio]").on("ifClicked",function(){$(this).prop("checked")&&$(this).iCheck("uncheck")})}function option1Checker(){$(document).on("change",".consequence-area-impact",function(){var a=ajax_area_impact(),b="case-file/get_consequence_description",c=$(this).val(),d=$(this).closest(".consequence").find(".consequence-priority").val(),e=$(this).closest(".consequence").find(".consequence-description"),f=$(this).closest(".consequence").find(".consequence-priority"),g=f.attr("class").split(" "),h=base_url+b;if(7==c){var i=a[0],j=a[1],k=a[2];f.val(i),f.children(":selected").text(j),f.not("option").removeClass(g[3]),f.not("option").addClass(k),e.html("")}else{var l={area_impact:c,priority_value:d};$.ajax({type:"POST",url:h,data:l,dataType:"html",success:function(a){e.html(null==a||""==a||void 0==a?"":a)}})}})}function option2Checker(){$(document).on("change",".consequence-priority",function(){var a="case-file/get_consequence_description",b=$(this).val(),c=$(this).closest(".consequence").find(".consequence-area-impact").val(),d=$(this).closest(".consequence").find(".consequence-description"),e={area_impact:c,priority_value:b},f=base_url+a;$.ajax({type:"POST",url:f,data:e,dataType:"html",success:function(a){d.html(null==a||""==a||void 0==a?"":a)}})})}function ajax_area_impact(){var a=[],b=[],c=[],d=[],e=[];return $(".consequence").each(function(){var f,g,h,i,j=[];$(this).find("select").each(function(a){0===a&&(f=$(this).val(),h=$(this).children(":selected").text()),1===a&&(g=$(this).val(),i=$(this).children(":selected").text(),single_consequence_classes=$(this).children(":selected").attr("class"),"undefined"!=typeof single_consequence_classes?(single_consequence_classes_split=single_consequence_classes.split(" "),single_consequence_class=single_consequence_classes_split[2]):single_consequence_class="bg-white")}),5!=f&&(c.push(f),d.push(g),j.push(f),a[f]=g,b[f]=i,e[f]=single_consequence_class)}),c.sort(function(a,b){return a-b}),[a[c[0]],b[c[0]],e[c[0]]]}function coloredSelectEffects(){$(document).on("change",".color-select",function(){var a=$("option:selected",this).attr("class").split(" ").pop(),b=$(this).attr("class"),c=b.split(" ").pop();$(this).removeClass(c),$(this).addClass(a)}),$(document).on("change",".colored-select",function(){if($(this).hasClass("consequence-priority")){var a="consequence-priority form-control colored-select";$(".colored-select option:selected").each(function(){var b=($(this).val(),$(this).text(),$(this).attr("class"));if("undefined"!=typeof b)var c=b.split(" "),d=c[2];else var d="bg-white";$(this).parent().attr("class",""),$(this).parent().attr("class",a+" "+d)})}else{var a="form-control colored-select";$(".colored-select option:selected").each(function(){var b=($(this).val(),$(this).text(),$(this).attr("class"));if("undefined"!=typeof b)var c=b.split(" "),d=c[1];else var d="bg-white";$(this).parent().attr("class",""),$(this).parent().attr("class",a+" "+d)})}})}function user_criticality(a,b,c,d,e){var f=$("#"+a),g=f.find("tbody"),c=c||"",d=d||!1,e=e||!1;if(f.length>0){var h=$("input[name=current_user_id]").val(),i="criticality-analysis/get_menu_edit",j=base_url+i,k={current_user_id:h,menu_type:b};$.ajax({type:"post",url:j,data:k,dataType:"json",success:function(a){var b=a.table_data,f=(a.table_info,a.user_info),h=f.asset_role,i=f.site_role;"superuser"!=h&&$("th.action").remove();b.length<1||$.each(b,function(a,f){var j="";j+='<tr id="data-row-'+f.menu_id+'" class="data-row">',0==a&&(j+='<td rowspan="'+b.length+'">'+c+"</td>"),j+='<td class="value" align="center">',j+="superuser"==h?'<input type="text" name="value" value="'+f.value+'" class="form-control decimal-only">':f.value,j+="</td>",j+='<td class="option-name">',j+="superuser"==h?e&&"siteadmin"!=i?'<input type="text" name="option_name" value="'+f.name+'" class="form-control" disabled>':'<input type="text" name="option_name" value="'+f.name+'" class="form-control">':f.name,j+="</td>",j+='<td class="description">',"superuser"==h?(j+='<input type="text" name="description" value="'+f.description+'" class="form-control">',d&&(j+='<input type="text" name="secondary_description" value="'+f.secondary_description+'" class="form-control">')):j+=f.description,j+="</td>",j+='<td class="text-center ',"superuser"!=h&&(j+="hidden"),j+=' ">',"superuser"==h&&(j+='<a href="#" class="btn btn-primary edit-menu"><span class="glyphicon glyphicon-floppy-disk"></span></a>'),j+='<p class="menu-id hidden">'+f.menu_id+"</p>",j+='<p class="value hidden">'+f.value+"</p>",j+='<p class="code hidden">'+f.code+"</p>",j+='<p class="color-class hidden">'+f.color_class+"</p>",j+='<p class="menu-category-id hidden">'+f.menu_category_id+"</p>",j+="</td>",j+="</tr>",g.append(j)})}})}}function update_user_criticality(){var a=$("#criticality-criteria");a.length>0&&$(document).on("click",".edit-menu",function(a){a.preventDefault();var b=$(this),c=b.closest(".data-row"),d=c.find(".value input[name=value]").val(),e=c.find(".description input[name=description]").val(),f=c.find(".description input[name=secondary_description]"),g=c.find(".option-name input[name=option_name]");if(f.length>0)var h=f.val();else var h=null;if(g.length>0)var i=g.val();else var i=null;var j=c.find(".menu-id").text(),k=c.find(".menu-category-id").text(),l=$("input[name=current_user_id]").val(),m="criticality-analysis/update_criticality_criteria",n=base_url+m,o={current_user_id:l,id:j,menu_category_id:k,name:i,value:d,description:e,secondary_description:h,color_class:null,code:null,order:null,level:null};console.log(o),$.ajax({type:"post",url:n,data:o,success:function(){console.log("saved")},error:function(a){console.log(a.responseText)}})})}function edit_criticality_score(){var a=$("#criticality-criteria");a.length>0&&$(document).on("click",".edit-menu",function(a){a.preventDefault();var b=$(this),c=b.closest(".data-row"),d=c.find(".description select").val(),e=c.find(".menu-id").text(),f=c.find(".menu-category-id").text(),g=$("input[name=current_user_id]").val(),h="criticality-analysis/update_criticality_criteria",i=base_url+h,j={current_user_id:g,id:e,menu_category_id:f,name:null,value:null,description:d,secondary_description:null,color_class:null,code:null,order:null,level:null};$.ajax({type:"post",url:i,data:j,error:function(a){console.log(a.responseText)}})})}function user_criticality_analysis_scoring(){var a=$("#criticality-analysis-scoring"),b=a.find("tbody");if(a.length>0){var c=$("input[name=current_user_id]").val(),d="criticality-analysis/get_menu_edit",e=base_url+d,f={current_user_id:c,menu_type:"criticality_score"};$.ajax({type:"post",url:e,data:f,dataType:"json",success:function(a){{var c=a.table_data,d=a.table_info,e=a.user_info,f=e.asset_role;e.site_role}"superuser"!=f&&$("th.action").remove();c.length<1||$.each(c,function(a,c){var e="";e+='<tr id="data-row-'+c.menu_id+'" class="data-row">',e+='<td class="name">',e+=c.name,e+="</td>",e+='<td class="description">',"superuser"==f?(e+='<select name="description" class="form-control">',e+=d.frequency,e+="</select>"):e+=c.description,e+="</td>",e+='<td class="text-center ',"superuser"!=f&&(e+="hidden"),e+=' ">',"superuser"==f&&(e+='<a href="#" class="btn btn-primary edit-menu"><span class="glyphicon glyphicon-floppy-disk"></span></a>'),e+='<p class="menu-id hidden">'+c.menu_id+"</p>",e+='<p class="value hidden">'+c.value+"</p>",e+='<p class="code hidden">'+c.code+"</p>",e+='<p class="color-class hidden">'+c.color_class+"</p>",e+='<p class="menu-category-id hidden">'+c.menu_category_id+"</p>",e+="</td>",e+="</tr>",b.append(e);var g=$(e),h="#"+g.attr("id")+" ",i=b.find(h+"select[name=description]");i.val(c.description)})}})}}function getActionTrackerList(a,b){var c=$("#action-tracker-container"),d=$("#action-tracker-ajax"),e=d.find("thead"),f=d.find("tbody"),g=$("#loading-action-tracker"),h=$("#no-action-tracker");if(d.length>0){var i=$("input[name=9s8fjshd324hd98s]").val(),j=$("input[name=current_user_id]").val(),k=b||null,l=a||null;null==l&&(l=j);var m="action_tracker/get_action_tracker",n=base_url+m,o={"9s8fjshd324hd98s":i,current_user_id:j,owner:l,status:k};e.html(""),f.html(""),g.removeClass("hidden"),$.ajax({type:"post",url:n,data:o,dataType:"json",success:function(a){g.addClass("hidden");var b=a.table_data;if(b.length<1)c.addClass("hidden"),$(".remove-action-tracker-row").addClass("hidden"),$(".add-action-tracker-row").closest(".panel-footer").addClass("hidden"),h.removeClass("hidden");else{var d=$(".add-action-tracker-row").closest(".panel-footer").hasClass("hidden");1==d&&$(".add-action-tracker-row").removeClass("hidden"),g.addClass("hidden"),0==h.hasClass("hidden")&&h.addClass("hidden"),c.hasClass("hidden")&&c.removeClass("hidden");var i=(a.status_dropdown,a.user_option_values),j=(a.document_name_dropdown,a.existing_document_name_dropdown),k=(a.tb_dropdown,a.equipment_dropdown),l=a.subaction_table_data,m="",n="",o="<tr>";o+='<th class="asset">Asset</th>',o+='<th class="tag-number">Tag Number</th>',o+='<th id="main-description" class="show-columns">Description <a id="toggle-columns" class="pull-right mini-tooltip show-hide-mini-tooltip" data-toggle="popover"><i class="glyphicon glyphicon-chevron-left"></i></a></th>',o+='<th class="more-details">Code</th>',o+='<th class="more-details">PCE</th>',o+='<th class="more-details">SCE</th>',o+='<th class="more-details">ECE</th>',o+='<th class="more-details">SIS</th>',o+='<th class="more-details">Status</th>',o+='<th class="more-details">CV</th>',o+='<th class="more-details">CAS</th>',o+='<th class="more-details">SPF</th>',o+='<th class="more-details">OBS</th>',o+='<th class="document-code">Document Code</th>',o+='<th class="entry-date">Entry Date</th>',o+='<th class="improvement-type">Improvement Type</th>',o+="<th>Action/Process Step</th>",o+="<th>Action Status</th>",o+='<th class="document-owner">Owner</th>',o+="<th>Location</th>",o+='<th class="th-action-group">Group</th>',o+='<th class="due-date">Due Date</th>',o+="<th>PG</th>",o+='<th class="comments">Comments</th>',o+='<th class="text-center actions">Action</th>',o+="</tr>",e.append(o),$.each(b,function(a,b){var c='<tr class="data-row">';c+='<td class="asset-value">',null!=b.asset&&(c+=b.asset),c+="</td>",c+='<td class="tag-number-value">',null!=b.tag_number&&(c+=b.tag_number),c+="</td>",c+='<td><select name="equipment_description" id="" class="table-select">',null!=b.criticality_analysis_id?(m='<option value="'+b.criticality_analysis_id+'">'+b.equipment_description+"&nbsp;</option>",n='<option value="'+b.criticality_analysis_id+'" selected>'+b.equipment_description+"&nbsp;</option>",c+="<option></option>",c+=n,k=k.replace(m,"")):c+="<option></option>",c+=k,c+="</select></td>",c+='<td class="more-details code-value">',null!=b.code&&(c+=b.code),c+="</td>",c+='<td class="pce-value">',"undefined"!=typeof b.pce&&(c+=b.pce),c+="</td>",c+='<td class="sce-value">',"undefined"!=typeof b.sce&&(c+=b.sce),c+="</td>",c+='<td class="ece-value">',"undefined"!=typeof b.ece&&(c+=b.ece),c+="</td>",c+='<td class="sis-value">',"undefined"!=typeof b.sis&&(c+=b.sis),c+="</td>",c+='<td class="status-value">',"undefined"!=typeof b.day_status&&(c+=b.day_status),c+="</td>",c+='<td class="cv-value">',"undefined"!=typeof b.cv&&(c+=b.cv),c+="</td>",c+='<td class="cas-value">',c+=b.cas,c+="</td>",c+='<td class="spf-value">',"undefined"!=typeof b.spf&&(c+=b.spf),c+="</td>",c+='<td class="obs-value">',"undefined"!=typeof b.obs&&(c+=b.obs),c+="</td>",c+='<td class="doc-code document-dropdown"><select name="document_id" class="table-select">',m='<option value="'+b.document_id+'">'+b.document_code+":"+b.document_name+"&nbsp;</option>",n='<option value="'+b.document_id+'" selected>'+b.document_code+": "+b.document_name+"&nbsp;</option>",null!=b.document_id&&(c+='<option value="null">:</option>'),c+=n,j=j.replace(m,""),c+=j,c+="</select></td>",c+='<td><input type="text" class="form-control datepicker-action-tracker" name="entry_date" value="',c+=b.entry_date,c+='"></td>',c+='<td><select name="types_of_improvement" id="" class="table-select improvement-type">',null!=b.improvement_id?(c+="<option></option>",c+=b.improvement):(c+="<option></option>",c+=b.improvement),c+="</select></td>",c+='<td><input type="text" class="form-control " name="action_process_step" value="',c+=b.action_process,c+='"></td>',c+='<td><select class="form-control color-select '+b.status_color+'" name="action_tracker_status">',c+=b.status,c+="</select></td>",c+='<td><select name="owner" id="document_name" class="select2-dropdown table-select document-owner">',c+='<option value="'+b.owner+'">'+b.full_name+"</option>",c+=i,c+="</select></td>",c+='<td><select name="location" class="table-select">',c+='<option value="null"></option>',c+=b.location,c+="</select></td>",c+='<td><select name="action_group" id="category" class="table-select select-action-group">',null!=b.category_id?(c+="<option></option>",c+=b.category):(c+="<option></option>",c+=b.category),c+="</select></td>",c+='<td><input type="text" class="form-control datepicker-action-tracker" name="due_date" value="',c+=b.due_date,c+='"></td>',c+='<td class="percentages"><select name="progress" class="table-select">',c+=b.progress,c+="</select></td>",c+='<td class="comments" ><input type="text" class="form-control " name="comments" value="',c+=b.comments,c+='"></td>',c+='<td class="text-center action-column"><a href="#" class="btn btn-primary add-subaction-tracker btn-sm"><span class="glyphicon glyphicon-chevron-down"></span></a> ',c+='<a href="#" class="btn btn-danger delete-row-action-tracker btn-sm"><span class="glyphicon glyphicon-minus"></span></a> ',c+='<span class="show-files-group">',b.uploads.length<1?c+='<a href="#" class="btn btn-danger show-files-action-tracker btn-sm" disabled><span class="glyphicon glyphicon-picture"></span></a> ':$.each(b.uploads,function(a,d){c+=0==a?'<a href="'+base_url+"uploads/"+d.filename+'" class="btn btn-success show-files-action-tracker btn-sm img-lightbox" data-lightbox="action-tracker-'+b.action_tracker_id+'"><span class="glyphicon glyphicon-picture"></span></a> ':'<a href="'+base_url+"uploads/"+d.filename+'" class="hidden btn btn-success show-files-action-tracker btn-sm img-lightbox" data-lightbox="action-tracker-'+b.action_tracker_id+'"><span class="glyphicon glyphicon-picture"></span></a> '}),c+="</span>",c+='<a href="#" class="btn btn-primary attach-action-tracker btn-sm"><span class="glyphicon glyphicon-paperclip"></span></a> ',c+='<a href="#" class="btn btn-primary edit-action-tracker btn-sm"><span class="glyphicon glyphicon-floppy-disk"></span></a> ',c+='<p class="action-tracker-id hidden">'+b.action_tracker_id+"</p></td>",c+="</tr>",f.append(c),$.each(l,function(a,c){if(b.action_tracker_id==c.action_tracker_id){var d='<tr class="subaction-data-row">';d+='<td colspan="13" class="subaction-equipment"></td>',d+='<td class="subaction-doc-code document-dropdown"><select name="document_id" class="table-select">',m='<option value="'+c.subaction_document_id+'">'+c.subaction_document_code+":"+c.subaction_document_name+"&nbsp;</option>",n='<option value="'+c.subaction_document_id+'" selected>'+c.subaction_document_code+": "+c.subaction_document_name+"&nbsp;</option>",null!=c.subaction_document_id&&(d+='<option value="null">:</option>'),d+=n,j=j.replace(m,""),d+=j,d+="</select></td>",d+='<td class="subaction-entry-date"><input type="text" class="form-control datepicker-action-tracker" name="entry_date" value="',d+=c.subaction_entry_date,d+='"></td>',d+='<td class="subaction-improvement"><select class="table-select improvement-type" name="types_of_improvement">',null!=c.subaction_improvement_id?(d+="<option></option>",d+=c.subaction_improvement):(d+="<option></option>",d+=c.subaction_improvement),d+="</select></td>",d+='<td class="subaction-process-step"><input type="text" class="form-control " name="action_process_step" value="',d+=c.subaction_process,d+='"></td>',d+='<td class="subaction-status"><select class="form-control color-select '+c.subaction_status_color+'" name="action_tracker_status">',d+=c.subaction_status,d+="</select></td>",d+='<td class="subaction-owner"><select name="owner" id="document_name" class="select2-dropdown table-select document-owner">',d+='<option value="'+c.subaction_owner+'">'+c.subaction_full_name+"</option>",d+=i,d+="</select></td>",d+='<td class="subaction-location"><select name="location" class="table-select">',d+='<option value="null"></option>',d+=c.subaction_location,d+="</select></td>",d+='<td class="subaction-group"><select name="action_group" id="category" class="table-select select-action-group">',null!=c.subaction_category_id?(d+="<option></option>",d+=c.subaction_category):(d+="<option></option>",d+=c.subaction_category),d+="</select></td>",d+='<td class="subaction-due-date"><input type="text" class="form-control datepicker-action-tracker" name="due_date" value="',d+=c.subaction_due_date,d+='"></td>',d+='<td class="subaction-pg"><select name="progress" class="table-select">',d+=c.subaction_progress,d+="</select></td>",d+='<td class="subaction-comments" ><input type="text" class="form-control " name="comments" value="',d+=c.subaction_comments,d+='"></td>',d+='<td class="subaction-action text-center">',d+='<a href="#" class="btn btn-primary add-subaction-tracker btn-sm" style="visibility:hidden"><span class="glyphicon glyphicon-chevron-down"></span></a> ',d+='<a href="#" class="btn btn-danger delete-row-subaction-tracker btn-sm"><span class="glyphicon glyphicon-minus"></span></a> ',d+='<span class="show-files-group">',c.uploads.length<1?d+='<a href="#" class="btn btn-danger show-files-subaction-tracker btn-sm" disabled><span class="glyphicon glyphicon-picture"></span></a> ':$.each(c.uploads,function(a,b){d+=0==a?'<a href="'+base_url+"uploads/"+b.filename+'" class="btn btn-success show-files-subaction-tracker btn-sm img-lightbox" data-lightbox="subaction-tracker-'+c.subaction_tracker_id+'"><span class="glyphicon glyphicon-picture"></span></a> ':'<a href="'+base_url+"uploads/"+b.filename+'" class="hidden btn btn-success show-files-subaction-tracker btn-sm img-lightbox" data-lightbox="subaction-tracker-'+c.subaction_tracker_id+'"><span class="glyphicon glyphicon-picture"></span></a> '}),d+="</span>",d+='<a href="#" class="btn btn-primary attach-subaction-tracker btn-sm"><span class="glyphicon glyphicon-paperclip"></span></a> ',d+='<a href="#" class="btn btn-primary edit-subaction-tracker btn-sm"><span class="glyphicon glyphicon-floppy-disk"></span></a> ',d+='<p class="subaction-tracker-id hidden">'+c.subaction_tracker_id+"</p>",d+='<p class="action-tracker-id hidden">'+b.action_tracker_id+"</p>",d+="</td>",d+="</tr>",f.append(d)}})}),dateEffects(),tooltipsAndPopovers(),updateActionTrackerDocumentDropdown()}}})}}function updateActionTracker(){$(document).on("click","a.edit-action-tracker",function(a){a.preventDefault();var b=$(this),c=b.closest(".data-row"),d=c.find(".action-tracker-id").text(),e=c.find("select[name=document_id]").val()||null,f=c.find("select[name=action_group]").val(),g=c.find("input[name=action_process_step]").val(),h=c.find("select[name=action_tracker_status]").val(),i=c.find("select[name=owner]").val(),j=c.find("input[name=entry_date]").val(),k=c.find("input[name=due_date]").val(),l=c.find("input[name=comments]").val(),m=c.find("select[name=location]").val(),n=c.find("select[name=progress]").val(),o=c.find("select[name=equipment_description]").val(),p=c.find("select[name=types_of_improvement]").val()||null,q=$("input[name=9s8fjshd324hd98s]").val(),r=$("input[name=current_user_id]").val(),s="action_tracker/update",t=base_url+s,u={"9s8fjshd324hd98s":q,current_user_id:r,action_tracker_id:d,criticality_analysis_id:o,action_document:e,action_category:f,action_process:g,action_tracker_status:h,owner:i,location:m,progress:n,due_date:k,entry_date:j,comments:l,improvement:p};$.ajax({type:"post",url:t,data:u,dataType:"json",success:function(a){c.find(".asset-value").text(""),c.find(".tag-number-value").text(""),c.find(".code-value").text(""),c.find(".pce-value").text(""),c.find(".sce-value").text(""),c.find(".ece-value").text(""),c.find(".sis-value").text(""),c.find(".cv-value").text(""),c.find(".status-value").text(""),c.find(".cas-value").text(""),c.find(".spf-value").text(""),c.find(".obs-value").text(""),null!=a.asset&&c.find(".asset-value").text(a.asset),null!=a.tag_number&&c.find(".tag-number-value").text(a.tag_number),null!=a.code&&c.find(".code-value").text(a.code),null!=a.pce&&c.find(".pce-value").text(a.pce),null!=a.sce&&c.find(".sce-value").text(a.sce),null!=a.ece&&c.find(".ece-value").text(a.ece),null!=a.sis&&c.find(".sis-value").text(a.sis),null!=a.cv&&c.find(".cv-value").text(a.cv),null!=a.day_status&&c.find(".status-value").html(a.day_status.replace(/\"/g,"")),null!=a.cas&&c.find(".cas-value").text(a.cas),null!=a.spf&&c.find(".spf-value").text(a.spf),null!=a.obs&&c.find(".obs-value").text(a.obs)}})})}function updateSubActionTracker(){$(document).on("click","a.edit-subaction-tracker",function(a){a.preventDefault();var b=$(this),c=b.closest(".subaction-data-row"),d=c.find(".subaction-tracker-id").text(),e=c.find("select[name=document_id]").val()||null,f=c.find("select[name=action_group]").val(),g=c.find("input[name=action_process_step]").val(),h=c.find("select[name=action_tracker_status]").val(),i=c.find("select[name=owner]").val(),j=c.find("input[name=entry_date]").val(),k=c.find("input[name=due_date]").val(),l=c.find("input[name=comments]").val(),m=c.find("select[name=location]").val(),n=c.find("select[name=progress]").val(),o=c.find("select[name=types_of_improvement]").val()||null,p=$("input[name=9s8fjshd324hd98s]").val(),q=$("input[name=current_user_id]").val(),r="action_tracker/update_subaction",s=base_url+r,t={"9s8fjshd324hd98s":p,current_user_id:q,subaction_tracker_id:d,action_document:e,action_category:f,action_process:g,action_tracker_status:h,owner:i,location:m,progress:n,due_date:k,entry_date:j,comments:l,improvement:o};$.ajax({type:"post",url:s,data:t,dataType:"json",success:function(){}})})}function addRemoveActionTrackerButtons(){var a=$("#action-tracker-ajax"),b=a.find("tbody");$(document).on("click",".add-action-tracker-row",function(){if(b.find(".data-row").length>0){var c=b.find("tr.data-row").filter(":last"),d=c.clone(),e=$("input[name=9s8fjshd324hd98s]").val(),f=$("input[name=current_user_id]").val(),g="action_tracker/create",h=base_url+g,i={"9s8fjshd324hd98s":e,owner:f,ajax_add:"true"};$.ajax({type:"post",url:h,data:i,success:function(b){d.find(".asset-value").text(""),d.find(".tag-number-value").text(""),d.find(".code-value").text(""),d.find(".pce-value").text(""),d.find(".sce-value").text(""),d.find(".ece-value").text(""),d.find(".sis-value").text(""),d.find(".status-value").text(""),d.find(".cv-value").text(""),d.find(".cas-value").text(""),d.find(".spf-value").text(""),d.find(".obs-value").text(""),d.find("input[name=action_process_step]").val(""),d.find("select[name=types_of_improvement] option:first-child").attr("selected",!0),d.find("select[name=action_group] option:first-child").attr("selected",!0),d.find("select[name=equipment_description] option:first-child").attr("selected",!0),d.find("select[name=document_id] option:first-child").attr("selected",!0),d.find("select[name=progress] option:first-child").attr("selected",!0),d.find("select[name=location] option:first-child").attr("selected",!0),d.find("select[name=action_tracker_status] option:selected").removeAttr("selected"),d.find("select[name=action_tracker_status]").removeAttr("class"),d.find("select[name=action_tracker_status]").addClass("form-control color-select bg-white"),d.find("select[name=action_tracker_status] option:selected").val(""),d.find("input[name=entry_date]").val(""),d.find("input[name=due_date]").val(""),d.find("select[name=owner]").val(),d.find(".action-tracker-id").text(b),d.find("select[name=group] option:selected").removeAttr("selected"),d.find("input[name=comments]").val("");var c='<a href="#" class="btn btn-danger show-files-action-tracker btn-sm" disabled><span class="glyphicon glyphicon-picture"></span></a> ';d.find("span.show-files-group").html(c),a.append(d),dateEffects(),tooltipsAndPopovers(),update_action_tracker_document_dropdown()}})}})}function deleteSpecificRowActionTracker(){$(document).on("click",".delete-row-action-tracker",function(a){a.preventDefault();{var b=$("#action-tracker-ajax"),c=$(this).closest(".data-row"),d=c.find(".action-tracker-id").text(),e=$("#confirm-delete-form"),f=e.find(".go-yes"),g=e.find(".go-no");$(this)}e.modal(),g.on("click",function(){$(this).closest(".modal").modal("hide")}),f.on("click",function(){e.modal("hide");var a=$("input[name=9s8fjshd324hd98s]").val(),f=$("input[name=current_user_id]").val(),g="action_tracker/delete_action_tracker",h=base_url+g,i={"9s8fjshd324hd98s":a,current_user_id:f,action_tracker_id:d};$.ajax({type:"post",url:h,data:i,success:function(){c.fadeOut(300,function(){$(this).remove()});var a=b.find("tr.subaction-data-row");$.each(a,function(){var a=$(this).find("p.action-tracker-id").text();parseInt(a)==d&&$(this).fadeOut(300,function(){$(this).remove()})}),b.find(".data-row").length<2&&($(".remove-action-tracker-row").addClass("hidden"),$(".add-action-tracker-row").addClass("hidden"),getActionTrackerList())}})})}),$(document).on("click",".delete-row-subaction-tracker",function(a){a.preventDefault();{var b=($("#action-tracker-ajax"),$(this).closest(".subaction-data-row")),c=b.find(".subaction-tracker-id").text(),d=$("#confirm-delete-form"),e=d.find(".go-yes"),f=d.find(".go-no");$(this)}d.modal(),f.on("click",function(){$(this).closest(".modal").modal("hide")}),e.on("click",function(){d.modal("hide");var a=$("input[name=9s8fjshd324hd98s]").val(),e=$("input[name=current_user_id]").val(),f="action_tracker/delete_subaction_tracker",g=base_url+f,h={"9s8fjshd324hd98s":a,current_user_id:e,subaction_tracker_id:c};$.ajax({type:"post",url:g,data:h,success:function(){b.fadeOut(300,function(){$(this).remove()})}})})})}function uploadFromSpecificRowActionTracker(){$(document).on("click",".attach-action-tracker",function(a){a.preventDefault();{var b=($("#action-tracker-ajax"),$(this).closest(".data-row")),c=b.find(".action-tracker-id").text(),d=$("#upload-form"),e=(d.find(".go-yes"),d.find(".go-no"));$(this)}d.modal();var f=d.find(".hidden-item"),g='<div class="row"><div class="col-sm-offset-1 col-sm-8"><div class="fileinput fileinput-new input-group" data-provides="fileinput"><div class="form-control action-tracker-upload" data-trigger="fileinput"><i class="glyphicon glyphicon-file fileinput-exists"></i> <span class="fileinput-filename"></span></div><span class="input-group-addon btn btn-default btn-file"><span class="glyphicon glyphicon-paperclip"></span><input type="file" name="userfile[]" ></span><a href="#" class="input-group-addon btn btn-default fileinput-exists" data-dismiss="fileinput"><span class="glyphicon glyphicon-remove"></span></a></div></div><div class="col-sm-3 hidden text-center"></div></div>';d.find(".upload-errors").html(""),d.find(".attach-files").html(g);var h='<input type="hidden" name="action_tracker_id" value="'+c+'" >',i={dataType:"json",beforeSubmit:function(){var a=1;if($('input[type="file"]').each(function(){var b=$(this);""==b.val()&&(a=0)}),0==a)return d.find(".upload-errors").html('<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><small>Please add a file on all input fields</small></div>'),!1;var b=d.find(".attach-files-container").height();d.find(".uploading-progress").css("height",b),d.find(".uploading-progress").removeClass("hidden"),d.find(".attach-files-container").addClass("hidden"),d.find(".upload-errors").html("")},success:function(a){var e=b.find("span.show-files-group"),f=d.find(".attach-files > .row");$.each(a.file_check,function(a,b){$.each(f,function(c){a==c&&($(this).find(".col-sm-3").removeClass("hidden"),$(this).find(".col-sm-3").html(0==b.checked?'<span class="glyphicon glyphicon-remove red"></span>':'<span class="glyphicon glyphicon-ok green"></span>'))})});var g="",h=a.upload_data;h.length<1?g+='<a href="#" class="btn btn-danger show-files-action-tracker btn-sm img-lightbox" data-lightbox="action-tracker-'+c+'" disabled><span class="glyphicon glyphicon-picture"></span></a> ':$.each(h,function(a,b){g+=0==a?'<a href="'+base_url+"uploads/"+b.filename+'" class="btn btn-success show-files-action-tracker btn-sm img-lightbox" data-lightbox="action-tracker-'+c+'"><span class="glyphicon glyphicon-picture"></span></a> ':'<a href="'+base_url+"uploads/"+b.filename+'" class="btn btn-success show-files-action-tracker btn-sm img-lightbox hidden" data-lightbox="action-tracker-'+c+'"><span class="glyphicon glyphicon-picture" ></span></a> '}),setTimeout(function(){d.find(".uploading-progress").addClass("hidden"),d.find(".attach-files-container").removeClass("hidden"),e.html(g),""!=a.errors&&d.find(".upload-errors").html('<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><br><small>'+a.errors+"</small></div>")},2e3)}};$("#upload-action-tracker").ajaxForm(i),f.html(h),e.on("click",function(){$(this).closest(".modal").modal("hide"),f.html("")})}),$(document).on("click",".attach-subaction-tracker",function(a){a.preventDefault();{var b=($("#action-tracker-ajax"),$(this).closest(".subaction-data-row")),c=b.find(".subaction-tracker-id").text(),d=$("#upload-form"),e=(d.find(".go-yes"),d.find(".go-no"));$(this)}d.modal();var f=d.find(".hidden-item"),g='<div class="row"><div class="col-sm-offset-1 col-sm-8"><div class="fileinput fileinput-new input-group" data-provides="fileinput"><div class="form-control action-tracker-upload" data-trigger="fileinput"><i class="glyphicon glyphicon-file fileinput-exists"></i> <span class="fileinput-filename"></span></div><span class="input-group-addon btn btn-default btn-file"><span class="glyphicon glyphicon-paperclip"></span><input type="file" name="userfile[]" ></span><a href="#" class="input-group-addon btn btn-default fileinput-exists" data-dismiss="fileinput"><span class="glyphicon glyphicon-remove"></span></a></div></div><div class="col-sm-3 hidden text-center"></div></div>';
d.find(".attach-files").html(g),d.find(".upload-errors").html("");var h='<input type="hidden" name="subaction_tracker_id" value="'+c+'" >',i={dataType:"json",beforeSubmit:function(){var a=1;if($('input[type="file"]').each(function(){var b=$(this);""==b.val()&&(a=0)}),0==a)return d.find(".upload-errors").html('<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><small>Please add a file on all input fields</small></div>'),!1;var b=d.find(".attach-files-container").height();d.find(".uploading-progress").css("height",b),d.find(".uploading-progress").removeClass("hidden"),d.find(".attach-files-container").addClass("hidden"),d.find(".upload-errors").html("")},success:function(a){var e=b.find("span.show-files-group"),f=d.find(".attach-files > .row");$.each(a.file_check,function(a,b){$.each(f,function(c){a==c&&($(this).find(".col-sm-3").removeClass("hidden"),$(this).find(".col-sm-3").html(0==b.checked?'<span class="glyphicon glyphicon-remove red"></span>':'<span class="glyphicon glyphicon-ok green"></span>'))})});var g="",h=a.upload_data;h.length<1?g+='<a href="#" class="btn btn-danger show-files-subaction-tracker btn-sm img-lightbox" data-lightbox="subaction-tracker-'+c+'" disabled><span class="glyphicon glyphicon-picture"></span></a> ':$.each(h,function(a,b){g+=0==a?'<a href="'+base_url+"uploads/"+b.filename+'" class="btn btn-success show-files-subaction-tracker btn-sm img-lightbox" data-lightbox="subaction-tracker-'+c+'"><span class="glyphicon glyphicon-picture"></span></a> ':'<a href="'+base_url+"uploads/"+b.filename+'" class="btn btn-success show-files-subaction-tracker btn-sm img-lightbox hidden" data-lightbox="subaction-tracker-'+c+'"><span class="glyphicon glyphicon-picture" ></span></a> '}),setTimeout(function(){d.find(".uploading-progress").addClass("hidden"),d.find(".attach-files-container").removeClass("hidden"),e.html(g),""!=a.errors&&d.find(".upload-errors").html('<div class="alert alert-danger fade in" role="alert"><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button><br><small>'+a.errors+"</small></div>")},2e3)}};$("#upload-action-tracker").ajaxForm(i),f.html(h),e.on("click",function(){$(this).closest(".modal").modal("hide"),f.html("")})})}function filterMasterActionTracker(){$(document).on("submit","#filter-master-action-tracker-form",function(a){var b=$(this),c=b.find("select[name=owner]").val(),d=b.find("select[name=status]").val();a.preventDefault(),getActionTrackerList(c,d)})}function addSubactionTrackerRow(){$(document).on("click",".add-subaction-tracker",function(a){a.preventDefault();var b=($("#action-tracker-ajax"),$(this).closest(".data-row")),c=b.find(".action-tracker-id").text(),d=b.clone();d.find("select[name=types_of_improvement] option:first-child").attr("selected",!0),d.find("select[name=action_group] option:first-child").attr("selected",!0),d.find("select[name=equipment_description] option:first-child").attr("selected",!0),d.find("select[name=document_id] option:first-child").attr("selected",!0),d.find("select[name=progress] option:first-child").attr("selected",!0),d.find("select[name=location] option:first-child").attr("selected",!0),d.find("select[name=action_tracker_status] option:selected").removeAttr("selected"),d.find("select[name=action_tracker_status] option:selected").val("");var e=d.find("td select[name=types_of_improvement]").html(),f=d.find("td select[name=action_group]").html(),g=(d.find("td select[name=equipment_description]").html(),d.find("td select[name=document_id]").html()),h=d.find("td select[name=progress]").html(),i=d.find("td select[name=location]").html(),j=d.find("td select[name=action_tracker_status]").html(),k=d.find("td select[name=owner]").html(),l=$("input[name=9s8fjshd324hd98s]").val(),m=$("input[name=current_user_id]").val(),n="action_tracker/create_subaction",o=base_url+n,p={"9s8fjshd324hd98s":l,owner:m,action_tracker_id:c};$.ajax({type:"post",url:o,data:p,dataType:"json",success:function(a){var d="";d+='<tr class="subaction-data-row"><td colspan="13" class="subaction-equipment"></td>',d+='<td class="subaction-doc-code document-dropdown"><select class="table-select">'+g+"</select></td>",d+='<td class="subaction-entry-date"><input type="text" class="form-control datepicker-action-tracker" name="entry_date" value=""></td>',d+='<td class="subaction-improvement"><select class="table-select improvement-type" name="types_of_improvement">'+e+"</select></td>",d+='<td class="subaction-process-step"><input class="form-control" name="action_process_step" value=""></td>',d+='<td class="subaction-status"><select class="form-control color-select bg-white" name="action_tracker_status">'+j+"</select></td>",d+='<td class="subaction-owner"><select class="table-select document-owner" name="owner" >'+k+"</select></td>",d+='<td class="subaction-location"><select class="table-select" name="location">'+i+"</select></td>",d+='<td class="subaction-group"><select class="table-select select-action-group" name="action_group">'+f+"</select></td>",d+='<td class="subaction-due-date"><input type="text" class="form-control datepicker-action-tracker" name="due_date" value=""></td>',d+='<td class="subaction-pg"><select class="table-select" name="progress">'+h+"</select></td>",d+='<td class="subaction-comments"><input type="text" class="form-control " name="comments" value=""></td>',d+='<td class="subaction-action text-center">',d+='<a href="#" class="btn btn-primary add-subaction-tracker btn-sm" style="visibility:hidden"><span class="glyphicon glyphicon-chevron-down"></span></a> ',d+='<a href="#" class="btn btn-danger delete-row-subaction-tracker btn-sm"><span class="glyphicon glyphicon-minus"></span></a> ',d+='<span class="show-files-group">',d+='<a href="#" class="btn btn-danger show-files-subaction-tracker btn-sm" disabled><span class="glyphicon glyphicon-picture"></span></a> ',d+="</span>",d+='<a href="#" class="btn btn-primary attach-subaction-tracker btn-sm"><span class="glyphicon glyphicon-paperclip"></span></a> ',d+='<a href="#" class="btn btn-primary edit-subaction-tracker btn-sm"><span class="glyphicon glyphicon-floppy-disk"></span></a> ',d+='<p class="subaction-tracker-id hidden">'+a+"</p>",d+='<p class="action-tracker-id hidden">'+c+"</p>",d+="</td>",d+="</tr>",console.log(a),b.after(d),dateEffects(),updateActionTrackerDocumentDropdown()}})})}function toggleActionTrackerTableColumns(){$(document).on("click","#toggle-columns",function(a){a.preventDefault();var b=$("table#action-tracker-ajax"),c=b.find("tr.data-row"),d=$(this).find("i");b.find(".show-columns").length>0?(c.find("td:nth-child(4),td:nth-child(5),td:nth-child(6),td:nth-child(7),td:nth-child(8),td:nth-child(9),td:nth-child(10),td:nth-child(11),td:nth-child(12),td:nth-child(13)").hide(),b.find("th:nth-child(4),th:nth-child(5),th:nth-child(6),th:nth-child(7),th:nth-child(8),th:nth-child(9),th:nth-child(10),th:nth-child(11),th:nth-child(12),th:nth-child(13)").hide(),b.find("td.subaction-equipment").attr("colspan",3),b.find("th#main-description").removeClass("show-columns"),b.animate({width:"1900px"},"slow",function(){d.removeClass("glyphicon-chevron-left"),d.addClass("glyphicon-chevron-right")})):(c.find("td:nth-child(4),td:nth-child(5),td:nth-child(6),td:nth-child(7),td:nth-child(8),td:nth-child(9),td:nth-child(10),td:nth-child(11),td:nth-child(12),td:nth-child(13)").show(),b.find("th:nth-child(4),th:nth-child(5),th:nth-child(6),th:nth-child(7),th:nth-child(8),th:nth-child(9),th:nth-child(10),th:nth-child(11),th:nth-child(12),th:nth-child(13)").show(),b.find("th#main-description").addClass("show-columns"),b.find("td.subaction-equipment").attr("colspan",13),b.animate({width:"2400px"},"slow",function(){d.removeClass("glyphicon-chevron-right"),d.addClass("glyphicon-chevron-left")}))})}function createNewAttachFileRowActionTracker(){$(document).on("click","button.clone-attach-files",function(a){a.preventDefault();var b='<div class="row"><div class="col-sm-offset-1 col-sm-8"><div class="fileinput fileinput-new input-group" data-provides="fileinput"><div class="form-control action-tracker-upload" data-trigger="fileinput"><i class="glyphicon glyphicon-file fileinput-exists"></i> <span class="fileinput-filename"></span></div><span class="input-group-addon btn btn-default btn-file"><span class="glyphicon glyphicon-paperclip"></span><input type="file" name="userfile[]" ></span><a href="#" class="input-group-addon btn btn-default fileinput-exists" data-dismiss="fileinput"><span class="glyphicon glyphicon-remove"></span></a></div></div><div class="col-sm-3 hidden text-center"></div></div>';$(".attach-files").append(b)})}function updateActionTrackerDocumentDropdown(){$(".document-owner").on("change",function(){var a=this.value,b=$(this).closest("td"),c=b.siblings("td.document-dropdown"),d=c.find("select[name=document_id]"),e=$("input[name=9s8fjshd324hd98s]").val(),f="action_tracker/get_action_tracker_document_owner",g=base_url+f,h={"9s8fjshd324hd98s":e,current_user_id:a};$.ajax({type:"post",url:g,data:h,dataType:"json",success:function(a){d.empty().append('<option value="null" selected="">:  &nbsp;</option>'+a)}})})}function createActionTrackerModal(){var a=($("a.create-action"),$("#create-action-tracker"));$(document).on("click","a.create-action",function(){a.modal();var b=$("body").find(".datepicker");$(b).css("z-index","10000")})}function scrollToData(a){$("html, body").animate({scrollTop:$(a).offset().top},1e3)}function button_scroll(){$(document).on("click","a.glyphicon-arrow-right",function(a){a.preventDefault();var b=$("#criticality-analysis-per-day").width(),c=$("#criticality-analysis-per-day").scrollLeft(),d=0,e=c%b;0!=e&&(d=b-e),$("#criticality-analysis-per-day").animate({scrollLeft:c+b+d},300)}),$(document).on("click","a.glyphicon-arrow-left",function(a){a.preventDefault();var b=$("#criticality-analysis-per-day").width(),c=$("#criticality-analysis-per-day").scrollLeft(),d=0,e=c%b;0!=e&&(d=b-e),$("#criticality-analysis-per-day").animate({scrollLeft:c-b+d},300)})}function scroll_top(){$.scrollUp({scrollName:"scrollUp",topDistance:"300",topSpeed:300,animation:"fade",animationInSpeed:200,animationOutSpeed:200,scrollText:"Scroll to top",activeOverlay:!1}),$("#scrollUp").html('<span class="glyphicon glyphicon-chevron-up"></span>')}function enableEndDateRange(a){if(null!=a&&(null!=a||""!=a)){var b=a.split("/"),c=daysInMonth(b[1],b[2]),d=c+"/"+b[1]+"/"+b[2];$("input#end_date_range").datepicker({format:"dd/mm/yyyy",startDate:a,endDate:d,autoclose:!0})}}function daysInMonth(a,b){return new Date(b,a,0).getDate()}function dateRange(){$("input#start_date_range").datepicker({format:"dd/mm/yyyy",autoclose:!0}).on("changeDate",function(){$("input#end_date_range").datepicker("remove"),$("input#end_date_range").val("");var a=$(this).val();enableEndDateRange(a)})}function ajaxSetup(){$.ajaxSetup({data:{"9s8fjshd324hd98s":$.cookie("k34lk3sdf08sdf34ddfr0")}})}function user_compliance_dashboard(a,b,c,d,e,f){var g=$("#compliance-dashboard"),h=$(".create-criticality-analysis");if(g.length>0){var i=g.find("tbody"),j=$("#loading-criticality-analysis"),k=$("#no-criticality-analysis"),l=$("#no-search-found"),m=$("input[name=current_user_id]").val(),a=a||null,b=b||null,c=c||null,d=d||null,f=f||null,e=e||null,n="criticality-analysis/get_criticality_analysis",o="compliance",p=base_url+n,q={current_user_id:m,asset:a,category:b,code:c,last_review_date:d,category_list:e,owner_id:f,query_type:o};j.removeClass("hidden"),g.hide(),l.addClass("hidden"),k.addClass("hidden"),$.ajax({type:"post",url:p,data:q,dataType:"json",success:function(b){var c=b.table_data,d=(b.table_info,b.user_info),e=(d.user_id,d.asset_role),f=(d.asset,d.site_role);"superuser"!=e&&$("th.action").remove(),"siteadmin"!=f&&h.remove();c.length<1?(j.addClass("hidden"),g.hide(),null!=a?l.removeClass("hidden"):k.removeClass("hidden")):(j.addClass("hidden"),g.show(),$.each(c,function(a,b){var c=(b.resultant_raw,b.average_performance_standard,b.compliant),d=b.compliant_color,f="";f+='<tr id="data-row-'+b.criticality_analysis_id+'" class="data-row">',f+='<td class="asset">',f+=b.asset,f+="</td>",f+='<td class="tag-number">',f+=b.tag_number,f+="</td>",f+='<td class="description">',f+=b.description,f+="</td>",f+='<td class="pce">',f+=b.pce,f+="</td>",f+='<td class="sce">',f+=b.sce,f+="</td>",f+='<td class="ece">',f+=b.ece,f+="</td>",f+='<td class="sis">',f+=b.sis,f+="</td>",f+='<td class="performance-standard ">',f+="superuser"!=e?b.performance_standard:'<input type="text" class="form-control decimal-only less-hundred" name="performance_standard" value="'+b.performance_standard+'">',f+="</td>",f+='<td class="unit-currently-available">',f+=b.available_right_now,f+="</td>",null!=b.group_rowspan&&(f+='<td class="resultant-availability text-middle text-center" rowspan="'+b.group_rowspan+'">',f+=b.resultant,f+="</td>",f+='<td class="compliant text-middle text-center '+d+'" rowspan="'+b.group_rowspan+'">',f+=c,f+="</td>"),f+='<td class="text-center">',"superuser"==e&&(f+='<a href="#" class="btn btn-primary edit-criticality-analysis"><span class="glyphicon glyphicon-floppy-disk"></span></a>'),f+='<p class="criticality-analysis-id hidden">'+b.criticality_analysis_id+"</p>",f+='<p class="asset-id hidden">'+b.asset_id+"</p>",f+='<p class="cas-id hidden">'+b.cas_id+"</p>",f+='<p class="user-id hidden">'+b.user_id+"</p>",f+="</td>",f+="</tr>",i.append(f)})),scrollToData("#compliance-dashboard table")}})}}function update_user_single_index(){{var a=$("#single-index-of-failing-equipment"),b=a.find("tbody");a.find(".edit-criticality-analysis"),$("#loading-criticality-analysis"),$("#no-search-found")}$(document).on("click","#single-index-of-failing-equipment .edit-criticality-analysis",function(a){a.preventDefault(),$row=$(this).closest(".data-row");var c=$row.find("select[name=owner]"),d=$row.find("select[name=defect_elimination]"),e=$row.find("select[name=project_plan]"),f=$row.find("select[name=technical_bulletin]"),g=$row.find("p.criticality-analysis-id"),h=c.val(),i=d.val(),j=e.val(),k=f.val(),l=g.text(),m="criticality-analysis/update_single_index",n=base_url+m,o={owner:h,defect_elimination:i,project_plan:j,technical_bulletin:k,criticality_analysis_id:l};$.ajax({type:"post",url:n,data:o,dataType:"html",success:function(){b.html("")}})})}function user_single_index(a,b,c,d,e,f,g,h){var i=$("#single-index-of-failing-equipment"),j=$(".create-criticality-analysis");if(i.length>0){var k=i.find("tbody"),l=$("#loading-criticality-analysis"),m=$("#no-criticality-analysis"),n=$("#no-search-found"),o=$("input[name=current_user_id]").val(),a=a||null,b=b||null,c=c||null,d=d||null,e=e||null,g=g||null,h=h||!1,f=f||null,p="criticality-analysis/get_criticality_analysis",q=base_url+p,r={current_user_id:o,asset:a,category:b,code:c,last_review_date:d,status:e,category_list:f,single_index_of_failing_equipment:"true",owner_id:g};h||(l.removeClass("hidden"),i.hide(),n.addClass("hidden"),m.addClass("hidden")),$.ajax({type:"post",url:q,data:r,dataType:"json",success:function(b){console.log(b);var c=[],d=b.table_data,e=b.table_info,f=b.user_info,g=(b.table_cv,f.user_id,f.asset_role),o=(f.asset,f.site_role);if(h){var p=new Date;$.each(d,function(a,b){c[a]={ASSET:b.asset,"TAG NUMBER":b.tag_number,DESCRIPTION:b.description,CODE:b.code,PCE:b.pce,SCE:b.sce,ECE:b.ece,SIS:b.sis,ALERT:b.alert,"CRITICALITY VALUE":b.cv,CAS:b.cas,STATUS:b.day_status}}),JSONtoCSV(c,"single_index_of_failing_equipment_"+p,!0)}else{"superuser"!=g&&$("th.action").remove(),"siteadmin"!=o&&j.remove();d.length<1?(l.addClass("hidden"),i.hide(),null!=a?n.removeClass("hidden"):m.removeClass("hidden")):(l.addClass("hidden"),i.show(),$.each(d,function(a,b){if(b.cv_greater_than_cas){var c="";c+='<tr id="data-row-'+b.criticality_analysis_id+'" class="data-row">',c+='<td class="asset">',c+=b.asset,c+="</td>",c+='<td class="tag-number">',c+=b.tag_number,c+="</td>",c+='<td class="description">',c+=b.description,c+="</td>",c+='<td class="code">',c+=b.code,c+="</td>",c+='<td class="pce">',c+=b.pce,c+="</td>",c+='<td class="sce">',c+=b.sce,c+="</td>",c+='<td class="ece">',c+=b.ece,c+="</td>",c+='<td class="sis">',c+=b.sis,c+="</td>",c+='<td class="atex-m">',c+=b.atex_m,c+="</td>",c+='<td class="atex-e">',c+=b.atex_e,c+="</td>",c+='<td class="day-status '+b.day_status_color+' ">',c+=b.day_status,c+="</td>",c+='<td class="criticality-value">',c+=b.cv,c+="</td>",c+='<td class="cas">',c+=b.cas,c+="</td>",c+='<td class="owner">',"superuser"!=g?c+=b.user_value:(c+='<select name="owner" class="form-control">',c+=e.user_dropdown,c+="</select>"),c+="</td>",c+='<td class="defect-elimination">',"superuser"!=g?c+=b.defect_elimination_value:(c+='<select name="defect_elimination" class="table-select">',c+=e.criticality_defect_elimination_dropdown,c+="</select>"),c+="</td>",c+='<td class="project-plan">',"superuser"!=g?c+=b.project_plan_value:(c+='<select name="project_plan" class="table-select">',c+=e.criticality_project_plan_dropdown,c+="</select>"),c+="</td>",c+='<td class="technical-bulletin">',"superuser"!=g?c+=b.technical_bulletin_value:(c+='<select name="technical_bulletin" class="table-select">',c+=e.criticality_technical_bulletin_dropdown,c+="</select>"),c+="</td>","superuser"==g&&(c+='<td class="text-center">',c+='<a href="#" class="btn btn-primary edit-criticality-analysis"><span class="glyphicon glyphicon-floppy-disk"></span></a>'),c+='<p class="criticality-analysis-id hidden">'+b.criticality_analysis_id+"</p>",c+='<p class="asset-id hidden">'+b.asset_id+"</p>",c+='<p class="cas-id hidden">'+b.cas_id+"</p>",c+='<p class="user-id hidden">'+b.user_id+"</p>",c+="</td>",c+="</tr>",k.append(c);var d=$(c),f="#"+d.attr("id")+" ",h=k.find(f+"select[name=owner]"),i=k.find(f+"select[name=defect_elimination]"),j=k.find(f+"select[name=project_plan]"),l=k.find(f+"select[name=technical_bulletin]");h.val(b.user_id),i.val(b.defect_elimination),j.val(b.project_plan),l.val(b.technical_bulletin)}}))}tableReflow()}})}}function user_failure_rate(a,b,c,d,e,f,g){var h=$("#failure-rate");if(h.length>0){var i=h.find("tbody"),j=$("#loading-criticality-analysis"),k=$("#no-criticality-analysis"),l=$("#no-search-found"),m=$("input[name=current_user_id]").val(),a=a||null,b=b||null,c=c||null,d=d||null,e=e||null,f=f||null,g=g||!1,n="criticality-analysis/get_criticality_analysis",o=base_url+n,p={current_user_id:m,asset:a,category:b,code:c,last_review_date:d,category_list:e,owner_id:f};g||(j.removeClass("hidden"),h.hide(),l.addClass("hidden"),k.addClass("hidden")),$.ajax({type:"post",url:o,data:p,dataType:"json",success:function(b){var c=[],d=b.table_data,e=b.table_info,f=b.user_info,m=(f.user_id,f.asset_role),n=(f.asset,f.site_role);if(g){var o=new Date;$.each(d,function(a,b){c[a]={ASSET:b.asset,"TAG NUMBER":b.tag_number,DESCRIPTION:b.description,REDUNDANCY:b.reliability_redundancy_value,SAFETY:b.safety_health_criticality_value,ENVIRONMENT:b.environmental_criticality_value,OPERATION:b.operational_criticality_value,REINSTATEMENT:b.reinstatement_value,CAS:b.cas,FREQUENCY:b.frequency_value}}),JSONtoCSV(c,"criticality_analysis_"+o,!0)}else{"superuser"!=m&&$("th.action").remove();d.length<1?(j.addClass("hidden"),h.hide(),null!=a?l.removeClass("hidden"):k.removeClass("hidden")):(j.addClass("hidden"),h.show(),$.each(d,function(a,b){var c="";"superuser"!=m?(c+='<tr id="data-row-'+b.criticality_analysis_id+'" class="data-row">',c+='<td class="asset">',c+=b.asset,c+="</td>",c+='<td class="tag-number">',c+=b.tag_number,c+="</td>",c+='<td class="description">',c+=b.description,c+="</td>",c+="<td>",c+=b.start_date,c+="</td>",c+="<td>",c+=b.failure_rate,c+="</td>",c+="<td>",c+=b.mtbf,c+="</td>",c+="<td>",c+=b.mttr,c+="</td>",c+="<td>",c+=b.fail_date,c+="</td>",c+="<td>",c+=b.repair_date,c+="</td>",c+="<td>",c+=b.estimated_repair_time,c+="</td>",c+="<td>",c+=b.actual_repair_time,c+="</td>",c+="</tr>"):(c+='<tr id="data-row-'+b.criticality_analysis_id+'" class="data-row">',c+='<td class="asset">',c+="siteadmin"!=n&&"sample"!=n?b.asset:'<select name="asset" class="table-select">'+e.criticality_asset_dropdown+"</select>",c+="</td>",c+='<td class="tag-number">',c+=b.tag_number,c+="</td>",c+='<td class="description">',c+=b.description,c+="</td>",c+='<td class="start-date">',c+='<input type="text" class="form-control datepicker" name="start_date" value="'+b.start_date+'">',c+="</td>",c+='<td class="failure-rate">',c+='<input type="text" class="form-control" name="failure_rate" value="'+b.failure_rate+'">',c+="</td>",c+='<td class="mtbf">',c+='<input type="text" class="form-control" name="mtbf" value="'+b.mtbf+'">',c+="</td>",c+='<td class="mttr">',c+='<input type="text" class="form-control" name="mttr" value="'+b.mttr+'">',c+="</td>",c+='<td class="fail-date">',c+='<input type="text" class="datepicker form-control" name="fail_date" value="'+b.fail_date+'" >',c+="</td>",c+='<td class="repair-date">',c+='<input type="text" class="datepicker form-control" name="repair_date" value="'+b.repair_date+'" >',c+="</td>",c+='<td class="estimated-repair-time">',c+='<input type="text" class=" form-control" name="estimated_repair_time" value="'+b.estimated_repair_time+'" >',c+="</td>",c+='<td class="actual-repair-time">',c+='<input type="text" class=" form-control" name="actual_repair_time" value="'+b.actual_repair_time+'" >',c+="</td>",c+='<td class="text-center">',c+='<a href="#" class="btn btn-primary edit-failure-rate"><span class="glyphicon glyphicon-floppy-disk"></span></a>',"siteadmin"==n&&(c+=' &nbsp;<a href="#" class="btn btn-danger delete-failure-rate"><span class="glyphicon glyphicon-trash"></span></a>'),c+='<p class="criticality-analysis-id hidden">'+b.criticality_analysis_id+"</p>",c+='<p class="asset-id hidden">'+b.asset_id+"</p>",c+='<p class="redundancy-id hidden">'+b.reliability_redundancy_id+"</p>",c+='<p class="safety-id hidden">'+b.safety_health_criticality_id+"</p>",c+='<p class="environment-id hidden">'+b.environmental_criticality_id+"</p>",c+='<p class="operation-id hidden">'+b.operational_criticality_id+"</p>",c+='<p class="reinstatement-id hidden">'+b.reinstatement_id+"</p>",c+='<p class="redundancy-value hidden">'+b.reliability_redundancy_value+"</p>",c+='<p class="safety-value hidden">'+b.safety_health_criticality_value+"</p>",c+='<p class="environment-value hidden">'+b.environmental_criticality_value+"</p>",c+='<p class="operation-value hidden">'+b.operational_criticality_value+"</p>",c+='<p class="reinstatement-value hidden">'+b.reinstatement_value+"</p>",c+='<p class="cas-id hidden">'+b.cas_id+"</p>",c+='<p class="user-id hidden">'+b.user_id+"</p>",c+="</td>",c+="</tr>"),i.append(c);var d=$(c),f="#"+d.attr("id")+" ",g=i.find(f+"select[name=asset]");g.val(b.asset_id)}))}dateEffects(),tableReflow()}})}}function edit_failure_rate(){{var a=$("#failure-rate tbody");$("a.edit-failure-rate"),$("#edit-failure-rate")}$(document).on("click","a.edit-failure-rate",function(b){a.html("");var c=($(this),$(this).closest(".data-row"));b.preventDefault();var d=c.find(".criticality-analysis-id").text(),e=c.find(".asset-id").text(),f=c.find(".tag-number").text(),g=c.find(".description").text(),h=c.find("input[name=start_date]").val(),i=c.find("input[name=failure_rate]").val(),j=c.find("input[name=mtbf]").val(),k=c.find("input[name=mttr]").val(),l=c.find("input[name=fail_date]").val(),m=c.find("input[name=repair_date]").val(),n=c.find("input[name=estimated_repair_time]").val(),o=c.find("input[name=actual_repair_time]").val(),p=(c.find(".cas-id").text(),"criticality-analysis/update_failure_rate"),q=base_url+p,r={criticality_analysis_id:d,asset:e,tag_number:f,description:g,start_date:h,failure_rate:i,mtbf:j,mttr:k,fail_date:l,repair_date:m,estimated_repair_time:n,actual_repair_time:o};$.ajax({type:"post",url:q,data:r,success:function(a){console.log(a),user_failure_rate()}})})}function delete_failure_rate(){{var a=$("#failure-rate tbody");$("a.delete-failure-rate")}$(document).on("click","a.delete-failure-rate",function(b){a.html("");var c=($(this),$(this).closest(".data-row"));b.preventDefault();var d=c.find(".criticality-analysis-id").text(),e="criticality-analysis/delete",f=base_url+e,g={criticality_analysis_id:d};$.ajax({type:"post",url:f,data:g,success:function(){user_failure_rate()}})})}function user_criticality_analysis(a,b,c,d,e,f,g){var h=$("#my-criticality-analysis"),i=$(".create-criticality-analysis");if(h.length>0){var j=h.find("tbody"),k=$("#loading-criticality-analysis"),l=$("#no-criticality-analysis"),m=$("#no-search-found"),n=$("input[name=9s8fjshd324hd98s]").val(),o=$("input[name=current_user_id]").val(),a=a||null,b=b||null,c=c||null,d=d||null,e=e||null,f=f||null,g=g||!1,p="criticality-analysis/get_criticality_analysis",q=base_url+p,r={"9s8fjshd324hd98s":n,current_user_id:o,asset:a,category:b,code:c,last_review_date:d,category_list:e,owner_id:f};g||(k.removeClass("hidden"),h.hide(),m.addClass("hidden"),l.addClass("hidden")),$.ajax({type:"post",url:q,data:r,dataType:"json",success:function(b){console.log(b);var c=[],d=b.table_data,e=b.table_info,f=b.user_info,n=(f.user_id,f.asset_role),o=(f.asset,f.site_role);if(g){var p=new Date;$.each(d,function(a,b){c[a]={ASSET:b.asset,"TAG NUMBER":b.tag_number,DESCRIPTION:b.description,REDUNDANCY:b.reliability_redundancy_value,SAFETY:b.safety_health_criticality_value,ENVIRONMENT:b.environmental_criticality_value,OPERATION:b.operational_criticality_value,REINSTATEMENT:b.reinstatement_value,CAS:b.cas,FREQUENCY:b.frequency_value}}),JSONtoCSV(c,"criticality_analysis_"+p,!0)}else{"superuser"!=n&&$("th.action").remove(),"siteadmin"!=o&&i.remove();d.length<1?(k.addClass("hidden"),h.hide(),null!=a?m.removeClass("hidden"):l.removeClass("hidden")):(k.addClass("hidden"),h.show(),$.each(d,function(a,b){var c="";"superuser"!=n?(c+='<tr id="data-row-'+b.criticality_analysis_id+'" class="data-row">',c+='<td class="asset">',c+=b.asset,c+="</td>",c+='<td class="tag-number">',c+=b.tag_number,c+="</td>",c+='<td class="description">',c+=b.description,c+="</td>",c+='<td class="redundancy">',c+=b.reliability_redundancy_value,c+="</td>",c+='<td class="safety">',c+=b.safety_health_criticality_value,c+="</td>",c+='<td class="environment" class="table-select">',c+=b.environmental_criticality_value,c+="</td>",c+='<td class="operation">',c+=b.operational_criticality_value,c+="</td>",c+='<td class="reinstatement">',c+=b.reinstatement_value,c+="</td>",c+='<td class="cas">',c+=b.cas,c+="</td>",c+='<td class="frequency">',c+=b.frequency_value,c+="</td>",c+='<td class="pce">',c+=b.pce,c+="</td>",c+='<td class="sce">',c+=b.sce,c+="</td>",c+='<td class="ece">',c+=b.ece,c+="</td>",c+='<td class="sis">',c+=b.sis,c+="</td>",c+='<td class="atex_m">',c+=b.atex_m,c+="</td>",c+='<td class="atex_e">',c+=b.atex_e,c+="</td>",c+="</tr>"):(c+='<tr id="data-row-'+b.criticality_analysis_id+'" class="data-row">',c+='<td class="asset">',c+="siteadmin"!=o&&"sample"!=o?b.asset:'<select name="asset" class="table-select">'+e.criticality_asset_dropdown+"</select>",c+="</td>",c+='<td class="tag-number">',c+=b.tag_number,c+="</td>",c+='<td class="description">',c+=b.description,c+="</td>",c+='<td class="redundancy">',c+='<select name="redundancy" class="table-select">'+e.criticality_redundancy_dropdown+"</select>",c+="</td>",c+='<td class="safety">',c+='<select name="safety" class="table-select">'+e.criticality_safety_dropdown+"</select>",c+="</td>",c+='<td class="environment" class="table-select">',c+='<select name="environment" class="table-select">'+e.criticality_environment_dropdown+"</select>",c+="</td>",c+='<td class="operation">',c+='<select name="operation" class="table-select">'+e.criticality_operation_dropdown+"</select>",c+="</td>",c+='<td class="reinstatement">',c+='<select name="reinstatement" class="table-select">'+e.criticality_reinstatement_dropdown+"</select>",c+="</td>",c+='<td class="cas">',c+=b.cas,c+="</td>",c+='<td class="frequency">',c+=b.frequency_value,c+="</td>",c+='<td class="pce">',c+=e.pce_dropdown,c+="</td>",c+='<td class="sce">',c+=e.sce_dropdown,c+="</td>",c+='<td class="ece">',c+=e.ece_dropdown,c+="</td>",c+='<td class="sis">',c+=e.sis_dropdown,c+="</td>",c+='<td class="atex_m">',c+=e.atex_m_dropdown,c+="</td>",c+='<td class="atex_e">',c+=e.atex_e_dropdown,c+="</td>",c+='<td class="text-center">',c+='<a href="#" class="btn btn-primary edit-criticality-analysis"><span class="glyphicon glyphicon-floppy-disk"></span></a>',"siteadmin"==o&&(c+=' &nbsp;<a href="#" class="btn btn-danger delete-criticality-analysis"><span class="glyphicon glyphicon-trash"></span></a>'),c+='<p class="criticality-analysis-id hidden">'+b.criticality_analysis_id+"</p>",c+='<p class="asset-id hidden">'+b.asset_id+"</p>",c+='<p class="redundancy-id hidden">'+b.reliability_redundancy_id+"</p>",c+='<p class="safety-id hidden">'+b.safety_health_criticality_id+"</p>",c+='<p class="environment-id hidden">'+b.environmental_criticality_id+"</p>",c+='<p class="operation-id hidden">'+b.operational_criticality_id+"</p>",c+='<p class="reinstatement-id hidden">'+b.reinstatement_id+"</p>",c+='<p class="redundancy-value hidden">'+b.reliability_redundancy_value+"</p>",c+='<p class="safety-value hidden">'+b.safety_health_criticality_value+"</p>",c+='<p class="environment-value hidden">'+b.environmental_criticality_value+"</p>",c+='<p class="operation-value hidden">'+b.operational_criticality_value+"</p>",c+='<p class="reinstatement-value hidden">'+b.reinstatement_value+"</p>",c+='<p class="cas-id hidden">'+b.cas_id+"</p>",c+='<p class="user-id hidden">'+b.user_id+"</p>",c+="</td>",c+="</tr>"),j.append(c);var d=$(c),f="#"+d.attr("id")+" ",g=j.find(f+"select[name=asset]"),h=j.find(f+"select[name=redundancy]"),i=j.find(f+"select[name=safety]"),k=j.find(f+"select[name=environment]"),l=j.find(f+"select[name=operation]"),m=j.find(f+"select[name=reinstatement]"),p=j.find(f+"select[name=pce]"),q=j.find(f+"select[name=sce]"),r=j.find(f+"select[name=ece]"),s=j.find(f+"select[name=sis]"),t=j.find(f+"select[name=atex_m]"),u=j.find(f+"select[name=atex_e]");g.val(b.asset_id),h.val(b.reliability_redundancy_id),i.val(b.safety_health_criticality_id),k.val(b.environmental_criticality_id),l.val(b.operational_criticality_id),m.val(b.reinstatement_id),p.val(b.pce_value),q.val(b.sce_value),r.val(b.ece_value),s.val(b.sis_value),t.val(b.atex_m_value),u.val(b.atex_e_value)}))}scrollToData("#my-criticality-analysis table"),dateEffects(),tableReflow()}})}}function edit_criticality_analysis(){{var a=$("#my-criticality-analysis tbody");$("a.edit-criticality-analysis"),$("#edit-criticality-analysis")}$(document).on("click","a.edit-criticality-analysis",function(b){a.html("");var c=($(this),$(this).closest(".data-row"));b.preventDefault();var d=c.find(".criticality-analysis-id").text(),e=c.find(".asset-id").text(),f=c.find(".tag-number").text(),g=c.find(".description").text(),h=c.find("select[name=redundancy]").val(),i=c.find("select[name=safety]").val(),j=c.find("select[name=environment]").val(),k=c.find("select[name=operation]").val(),l=c.find("select[name=reinstatement]").val(),m=c.find("select[name=pce]").val(),n=c.find("select[name=sce]").val(),o=c.find("select[name=ece]").val(),p=c.find("select[name=sis]").val(),q=c.find("select[name=atex_m]").val(),r=c.find("select[name=atex_e]").val(),s=c.find(".cas-id").text();token=$("input[name=9s8fjshd324hd98s]").val();var t="criticality-analysis/update",u=base_url+t,v={criticality_analysis_id:d,asset:e,tag_number:f,description:g,reliability_redundancy:h,safety_health_criticality:i,environmental_criticality:j,operational_criticality:k,reinstatement:l,status:"",cas:s,frequency:"",pce:m,sce:n,ece:o,sis:p,atex_m:q,atex_e:r,"9s8fjshd324hd98s":token};$.ajax({type:"post",url:u,data:v,success:function(){user_criticality_analysis(),user_single_index()}})})}function delete_criticality_analysis(){{var a=$("#my-criticality-analysis tbody");$("a.delete-criticality-analysis")}$(document).on("click","a.delete-criticality-analysis",function(b){a.html("");
var c=($(this),$(this).closest(".data-row"));b.preventDefault();var d=c.find(".criticality-analysis-id").text();token=$("input[name=9s8fjshd324hd98s]").val();var e="criticality-analysis/delete",f=base_url+e,g={criticality_analysis_id:d,"9s8fjshd324hd98s":token};$.ajax({type:"post",url:f,data:g,success:function(){user_criticality_analysis(),user_single_index()}})})}function update_criticality_analysis_view(a,b){var a=a||"criticality_analysis",b=b||null,c=$("input[name=9s8fjshd324hd98s]").val(),d=get_criticality_analysis(b),e="criticality-analysis/update_view",f=base_url+e,g={"9s8fjshd324hd98s":c,json_view_name:a,json_view_data:d};$.ajax({type:"post",url:f,data:g})}function createCriticalityAnalysis(){var a=($("a.create-criticality-analysis"),$("#create-criticality-analysis")),b=$("#my-criticality-analysis tbody");$(document).on("click","a.create-criticality-analysis",function(){a.modal();var b=$("body").find(".datepicker");$(b).css("z-index","10000")}),$(document).on("submit","#create-criticality-analysis-form",function(c){c.preventDefault(),a.modal("hide");var d=$(this),e=d.serializeArray(),f="criticality-analysis/create",g=base_url+f;b.html(""),$.ajax({type:"post",url:g,data:e,success:function(){user_criticality_analysis(),user_single_index()}})})}function update_user_compliance(){{var a=$("#compliance-dashboard"),b=a.find("tbody");a.find(".edit-criticality-analysis"),$("#loading-criticality-analysis"),$("#no-search-found")}$(document).on("click","#compliance-dashboard .edit-criticality-analysis",function(a){a.preventDefault(),$row=$(this).closest(".data-row");var c=$row.find("input[name=performance_standard]"),d=$row.find("p.criticality-analysis-id"),e=c.val(),f=d.text(),g=$("input[name=9s8fjshd324hd98s]").val(),h="criticality-analysis/update-compliance",i=base_url+h,j={"9s8fjshd324hd98s":g,performance_standard:e,criticality_analysis_id:f};console.log(j),$.ajax({type:"post",url:i,data:j,dataType:"html",success:function(a){console.log(a),b.html(""),user_compliance_dashboard()}})})}function filterCriticalityAnalysis(){$(document).on("submit","#filter-criticality-analysis-form",function(a){var b,c=$(this),d=$("#my-criticality-analysis"),e=$("#single-index-of-failing-equipment"),f=$("#compliance-dashboard"),g=$("#failure-rate"),h=null,i=c.find("select[name=filter_asset]").val(),j=c.find("input[name=filter_code]").val(),k=c.find("select[name=filter_last_review_date]").val(),l=c.find("select[name=filter_owner]").val(),m=c.find("input:checked[name='filter_status[]']"),n=c.find("input:checked[name='filter_category[]']"),o=[];if(m.each(function(){o.push($(this).val())}),n.length>0){var p=[];n.each(function(){p.push($(this).val())})}else p=null;a.preventDefault(),d.length>0?(b=d.find("tbody"),b.html(""),user_criticality_analysis(i,h,j,k,p,l)):e.length>0?(b=e.find("tbody"),b.html(""),user_single_index(i,h,j,k,o,p,l)):f.length>0?(b=f.find("tbody"),b.html(""),user_compliance_dashboard(i,h,j,k,p,l)):g.length>0&&(b=g.find("tbody"),b.html(""),user_failure_rate(i,h,j,k,p,l))})}function filterCriticalityAnalysisValues(){var a=$("#filter-criticality-analysis-history-form");a.submit(function(b){b.preventDefault(),$criticality_analysis_history=$("#my-criticality-analysis-history"),$compliance_dashboard=$("#compliance-dashboard");var c=a.find("input[name=start_date]").val();if(""==c){var d=new Date,e=d.getDate(),f=d.getMonth()+1,g=d.getFullYear();10>e&&(e="0"+e),10>f&&(f="0"+f),d=e+"/"+f+"/"+g,a.find("input[name=start_date]").val(d),enableEndDateRange(d),a.find("input[name=end_date]").val(d)}var h,i,j=a.find("input[name=end_date]").val(),k=c.split("/"),l=k[1],m=k[0];""==j?(i=k[0],a.find("input[name=end_date]").val(c)):(h=j.split("/"),i=h[0]);{var n=k[2],o=null,p=a.find("select[name=asset]").val(),q=a.find("input[name=equipment_code]").val(),r=a.find("select[name=category]").val(),s=a.find("select[name=filter_last_review_date]").val(),t=a.find("select[name=filter_owner]").val(),u=a.find("input:checked[name='filter_category[]']");daysInMonth(l,n)}if(u.length>0){var v=[];u.each(function(){v.push($(this).val())})}else v=null;$criticality_analysis_history.length>0?getCriticalityAnalysisHistoryDailyValues(m,i,l,n,o,p,r,q,s,v,t):$compliance_dashboard.length>0&&($compliance_dashboard.find("tbody").html(""),user_compliance_dashboard(p,r,q,s,t))})}function getCriticalityAnalysisHistoryDailyValues(a,b,c,d,e,f,g,h,i,j,k,l){var m=$("#criticality-analysis-per-day"),n=$("#my-criticality-analysis-history"),o=$(".no-search-found-equipment-status"),p=$("#loading-criticality-analysis-history"),q=$("#loading-criticality-analysis-history_values");if($(".arrow-scroll").addClass("hidden"),m.length>0){var r=n.find("tbody"),s=m.find("tbody"),t=m.find("thead"),u=(m.find(".date-today"),$("input[name=9s8fjshd324hd98s]").val()),v=$("input[name=current_user_id]").val(),w=new Date,a=a||null,b=b||null,x=c||null,y=d||null,f=f||null,g=g||null,h=h||null,i=i||null,z="'FontAwesome'",l=l||!1,j=j||null,k=k||null;if(null==a&&(a=w.getDate()),null==b&&(b=w.getDate()),null==x&&(x=w.getMonth()+1),null==y&&(y=w.getFullYear()),a=parseInt(a),b=parseInt(b),y=parseInt(y),x=parseInt(x),a==b&&x&&y){o.find(".hidden").length<1&&o.addClass("hidden");var A="criticality_analysis/get_criticality_analysis_history_daily",B=base_url+A,C={"9s8fjshd324hd98s":u,current_user_id:v,day:a,month:x,year:y,asset:f,category:g,code:h,last_review_date:i,category_list:j,owner_id:k};p.removeClass("hidden"),n.hide(),m.hide(),q.removeClass("hidden"),$.ajax({type:"post",url:B,data:C,dataType:"json",success:function(b){m.removeClass("width-2-days"),m.removeClass("width-monthly");var c=b.table_data,d=b.table_info,e=b.item_list;q.addClass("hidden"),m.show(),r.html(""),s.html(""),t.html(""),p.addClass("hidden");if(c.length<1)m.hide(),n.hide(),o.removeClass("hidden");else{p.addClass("hidden"),n.show(),$.each(e,function(a,b){var c="";c+='<tr id="data-row-'+b.criticality_analysis_id+'" class="data-row fix-row-height">',c+='<td class="asset no-wrap-style">',c+=b.asset,c+="</td>",c+='<td class="tag-number no-wrap-style">',c+=b.tag_number,c+="</td>",c+='<td class="description no-wrap-style">',c+=b.description,c+="</td>",c+='<td class="pce">',c+=b.pce,c+="</td>",c+='<td class="sce">',c+=b.sce,c+="</td>",c+='<td class="ece">',c+=b.ece,c+="</td>",c+='<td class="sis">',c+=b.sis,c+="</td>",c+='<td class="atex_m">',c+=b.atex_m,c+="</td>",c+='<td class="atex_e">',c+=b.atex_e,c+="</td>",c+='<td class="code">',c+=b.alert,c+="</td>",c+='<td class="cv">',c+=b.cv,c+="</td>",c+='<td class="code">',c+='<select name="obs" class="table-select color-select '+b.obs_color+'">'+d.criticality_obs_dropdown+"</select>",c+="</td>",c+='<td class="code">',c+=b.cas,c+="</td>",c+='<td class="code">',c+=b.hours,c+="</td>",c+='<td class="code">',c+=b.availability,c+="</td>",c+="</tr>",r.append(c);var e=$(c),f="#"+e.attr("id")+" ",g=r.find(f+"select[name=obs]");g.val(b.obs)});var f=[],g=a+"-"+x+"-"+y,h="<tr>";h+='<th class="text-center" colspan=5>'+g+"</th>",h+="</tr>",h+="<tr>",h+='<th class="data-input-row-columns-daily">SPF</th>',h+='<th class="data-input-row-columns-daily">Avail</th>',h+='<th class="data-input-status-columns-daily no-wrap-style">Status &nbsp;<a class="mini-tooltip status-mini-tooltip" data-toggle="popover"><i class="fa fa-question-circle hidden-xs"></i></a></th>',h+='<th class="data-input-hour-column-daily">Hours</th>',h+='<th class="data-input-action-column-daily text-center">Action</th>',h+="</tr>",t.append(h),$.each(c,function(b,c){var g="";g+='<tr id="data-row-'+c.criticality_analysis_id+'" class="data-row fix-row-height">',g+='<td class="day_spf_'+a+'">',g+='<div class=""><select name="spf" class="table-select color-select '+c.day_spf_color+'">'+d.criticality_spf_dropdown+"</select></div>",g+="</td>",g+='<td class="day_availability_'+a+'">',g+='<div class=""><select name="avail" class="table-select color-select '+c.day_availability_color+'">'+d.criticality_avail_dropdown+"</select></div>",g+="</td>",g+='<td class="day_status_'+a+'">',g+='<div class=""><select name="status" style="font-family:lato,'+z+';" class="table-select color-select '+c.day_status_color+'">'+d.criticality_status_dropdown+"</select></div>",g+="</td>",g+='<td class="day_hours_'+a+'">',g+=null==c.day_hours||"null"==c.day_hours?'<div class=""><input type="text" class="form-control input-small" name="hours" value=""></div>':'<div class=""><input type="text" class="form-control input-small" name="hours" value="'+c.day_hours+'"></div>',g+="</td>",g+='<td class="action text-center">',g+='<a href="#" class="btn btn-sm btn-primary edit-daily-value day-value-'+a+'"><span class="glyphicon glyphicon-floppy-disk"></span></a>',g+='<p class="sis-id hidden">'+c.criticality_analysis_id+"</p>",g+='<p class="button-day hidden">'+a+"</p>",g+='<p class="button-month hidden">'+x+"</p>",g+='<p class="button-year hidden">'+y+"</p>",g+="</td>",g+="</tr>",s.append(g);var h=$(g),i="#"+h.attr("id")+" ",j=s.find(i+"select[name=spf]"),k=s.find(i+"select[name=avail]"),m=s.find(i+"select[name=status]");0!=c.day_spf&&j.val(c.day_spf),0!=c.day_availability&&k.val(c.day_availability),0!=c.day_status&&m.val(c.day_status);var n=$("#criticality-analysis-data-input").find("tr#data-row-"+c.criticality_analysis_id);n.find(".cv").val(null!=c.day_cv?c.day_cv:0),l&&($.each(e,function(a,b){return b.criticality_analysis_id==c.criticality_analysis_id?(f[a]={ASSET:b.asset,"TAG NUMBER":b.tag_number,DESCRIPTION:b.description,ALERT:b.alert,CV:b.cv,OBS:b.obs,CAS:b.cas,"TOTAL HOURS":b.hours,AVAILABILITY:b.availability},!1):void 0}),f[b].SPF=c.day_spf_value,f[b].AVAIL=c.day_availability_value,f[b].STATUS=c.day_status_value,f[b].HOURS=c.day_hours)}),l&&JSONtoCSV(f,"sample",!0)}tooltipsAndPopovers(),scrollToData("#criticality-analysis-data-input")}})}else if(a!=b&&x&&y){m.removeClass("width-2-days"),m.removeClass("width-monthly"),$container_width=m.width(),o.find(".hidden").length<1&&o.addClass("hidden"),a=parseInt(a),b=parseInt(b),m.addClass(2>b-a?"width-2-days":"width-monthly");var A="criticality_analysis/get_criticality_analysis_history_monthly",B=base_url+A,C={"9s8fjshd324hd98s":u,current_user_id:v,month:x,start_day:a,end_day:b,year:y,asset:f,category:g,code:h,last_review_date:i,category_list:j,owner_id:k};m.hide(),q.removeClass("hidden"),p.removeClass("hidden"),n.hide(),$.ajax({type:"post",url:B,data:C,dataType:"json",success:function(c){var d=[];q.addClass("hidden"),m.show(),r.html(""),s.html(""),t.html("");var e=c.table_data,f=c.sis_count,g=c.table_info,h=c.item_list;p.addClass("hidden"),n.show(),$.each(h,function(a,b){var c="";c+='<tr id="data-row-'+b.criticality_analysis_id+'" class="data-row fix-row-height">',c+='<td class="asset no-wrap-style">',c+=b.asset,c+="</td>",c+='<td class="tag-number no-wrap-style">',c+=b.tag_number,c+="</td>",c+='<td class="description no-wrap-style">',c+=b.description,c+="</td>",c+='<td class="pce">',c+=b.pce,c+="</td>",c+='<td class="sce">',c+=b.sce,c+="</td>",c+='<td class="ece">',c+=b.ece,c+="</td>",c+='<td class="sis">',c+=b.sis,c+="</td>",c+='<td class="atex_m">',c+=b.atex_m,c+="</td>",c+='<td class="atex_e">',c+=b.atex_e,c+="</td>",c+='<td class="code">',c+=b.alert,c+="</td>",c+='<td class="cv">',c+=b.cv,c+="</td>",c+='<td class="code">',c+='<select name="obs" class="table-select color-select '+b.obs_color+'">'+g.criticality_obs_dropdown+"</select>",c+="</td>",c+='<td class="code">',c+=b.cas,c+="</td>",c+='<td class="code">',c+=b.hours,c+="</td>",c+='<td class="code">',c+=b.availability,c+="</td>",c+="</tr>",r.append(c);var d=$(c),e="#"+d.attr("id")+" ",f=r.find(e+"select[name=obs]");f.val(b.obs)});if(e.length<1)o.removeClass("hidden"),m.hide(),n.hide();else{b-a>=1&&$(".arrow-scroll").removeClass("hidden");for(var i="<tr>",j=(daysInMonth(x,y),a);b>=j;j++)i+='<th class="data-input-row-header-column text-center resize-column" colspan=5 style="width:'+$container_width+'px;">&nbsp;<span class="">'+j+"-"+x+"-"+y+"</span>&nbsp;</th>";i+="</tr>",t.append(i);for(var k="<tr>",j=a;b>=j;j++)k+='<th class="data-input-row-columns">SPF</th>',k+='<th class="data-input-row-columns">Avail</th>',k+='<th class="data-input-row-columns no-wrap-style">Status &nbsp;<a class="mini-tooltip status-mini-tooltip" data-toggle="popover"><i class="fa fa-question-circle hidden-xs"></i></a></th>',k+='<th class="data-input-row-columns">Hours</th>',k+='<th class="data-input-action-column text-center">Action</th>';k+="</tr>",t.append(k),$.each(f,function(c,f){var i=c;l&&$.each(h,function(a,b){return b.criticality_analysis_id==f.sis_id?(d[a]={ASSET:b.asset,"TAG NUMBER":b.tag_number,DESCRIPTION:b.description,ALERT:b.alert,CV:b.cv,OBS:b.obs,CAS:b.cas,"TOTAL HOURS":b.hours,AVAILABILITY:b.availability},!1):void 0});var j="";j+='<tr id="data-row-'+f.sis_id+'" class="data-row">';for(var k=[],m=0;a>m;m++)k.push("none");for(var n=a;b>=n;n++){var o=0,p="",q="";if($.each(e,function(a,b){if(b.month&&(p=b.month),b.year&&(q=b.year),b.day==n&&b.criticality_analysis_id==f.sis_id){j+='<td class="day_spf_'+n+'">',j+=b.day?'<div class=""><select name="spf" class="table-select select-monthly color-select '+b.day_spf_color+'">'+g.criticality_spf_dropdown+"</select></div>":'<div class=""><select name="spf" class="table-select select-monthly color-select bg-white">'+g.criticality_spf_dropdown+"</select></div>",j+="</td>",j+='<td class="day_availability_'+n+'">',j+=b.day_availability?'<div class=""><select name="avail" class="table-select select-monthly color-select '+b.day_availability_color+'">'+g.criticality_avail_dropdown+"</select></div>":'<div class=""><select name="avail" class="table-select select-monthly color-select bg-white">'+g.criticality_avail_dropdown+"</select></div>",j+="</td>",j+='<td class="day_status_'+n+'">',j+=b.day_status?'<div class=""><select name="status"  style="font-family:lato,'+z+'; font-size: 16px;" class="table-select select-monthly color-select '+b.day_status_color+'">'+g.criticality_status_dropdown+"</select></div>":'<div class=""><select name="status"  style="font-family:lato,'+z+'; font-size: 16px;" class="table-select select-monthly color-select bg-white">'+g.criticality_status_dropdown+"</select></div>",j+="</td>",j+='<td class="day_hours_'+n+'">',j+=b.day_hours?'<div class=""><input type="text" class="form-control input-monthly" name="hours" value="'+b.day_hours+'"></div>':'<div class=""><input type="text" class="form-control input-monthly" name="hours" value=""></div>',j+="</td>",j+='<td class="action text-center">',j+='<a href="#" class="btn btn-sm btn-primary edit-daily-value day-value'+n+'"><span class="glyphicon glyphicon-floppy-disk"></span></a>',j+='<p class="sis-id hidden">'+f.sis_id+"</p>",j+='<p class="button-day hidden">'+b.day+"</p>",j+='<p class="button-month hidden">'+b.month+"</p>",j+='<p class="button-year hidden">'+b.year+"</p>",j+="</td>",o=1;var c=$(j),e="#"+c.attr("id")+" ",h=(s.find(e+"select[name=spf]"),s.find(e+"select[name=avail]"),s.find(e+"select[name=status]"),{spf:b.day_spf,avail:b.day_availability,status:b.day_status});return k.push(h),l&&(d[i]["SPF "+n]=b.day_spf_value,d[i]["AVAIL "+n]=b.day_availability_value,d[i]["STATUS "+n]=b.day_status_value,d[i]["HOURS "+n]=b.day_hours),!1}}),0==o){j+='<td class="day_spf_'+n+'">',j+='<div class=""><select name="spf" class="table-select select-monthly color-select bg-white">'+g.criticality_spf_dropdown+"</select></div>",j+="</td>",j+='<td class="day_availability_'+n+'">',j+='<div class=""><select name="avail" class="table-select select-monthly color-select bg-white">'+g.criticality_avail_dropdown+"</select></div>",j+="</td>",j+='<td class="day_status_'+n+'">',j+='<div class=""><select name="status"  style="font-family:lato,'+z+'; font-size: 16px;" class="table-select select-monthly color-select bg-white">'+g.criticality_status_dropdown+"</select></div>",j+="</td>",j+='<td class="day_hours_'+n+'">',j+='<div class=""><input type="text" class="form-control input-monthly" name="hours" value=""></div>',j+="</td>",j+='<td class="action text-center">',j+='<a href="#" class="btn btn-sm btn-primary edit-daily-value day-value-'+n+'"><span class="glyphicon glyphicon-floppy-disk"></span></a>',j+='<p class="sis-id hidden">'+f.sis_id+"</p>",j+='<p class="button-day hidden">'+n+"</p>",j+='<p class="button-month hidden">'+x+"</p>",j+='<p class="button-year hidden">'+y+"</p>",j+="</td>";var r="none";k.push(r),l&&(d[i]["SPF "+n]=" ",d[i]["AVAIL "+n]=" ",d[i]["STATUS "+n]=" ",d[i]["HOURS "+n]=" ")}}j+="</tr>",s.append(j);for(var n=a;b>=n;n++){if("none"!=k[n]){var t=$(j),u="#"+t.attr("id")+" ",v=s.find(u+"> .day_spf_"+n+" select[name=spf]"),w=s.find(u+"> .day_availability_"+n+" select[name=avail]"),A=s.find(u+"> .day_status_"+n+" select[name=status]");0!=k[n].spf&&v.val(k[n].spf),0!=k[n].avail&&w.val(k[n].avail),0!=k[n].status&&A.val(k[n].status)}}}),l&&JSONtoCSV(d,"sample",!0)}tooltipsAndPopovers(),scrollToData("#criticality-analysis-data-input")}})}}}function editCriticalityAnalysisHistoryValues(){$("#criticality-analysis-per-day"),$("a.edit-daily-value");$(document).on("click","a.edit-daily-value",function(a){var b=($(this),$(this).closest(".data-row")),c=$(this).parent(),d=c.find(".button-day").text(),e=c.find(".button-month").text(),f=c.find(".button-year").text(),g=c.find(".sis-id").text(),h=b.find(".day_spf_"+d+" > div > select[name=spf]").val(),i=b.find(".day_availability_"+d+" > div > select[name=avail]").val(),j=b.find(".day_status_"+d+" > div > select[name=status]").val(),k=b.find(".day_hours_"+d+" > div > input[name=hours]").val();a.preventDefault(),token=$("input[name=9s8fjshd324hd98s]").val();var l="criticality-analysis/update_single_criticality_analysis_history_values",m=base_url+l,n={criticality_analysis_id:g,day_spf:h,day_availability:i,day_status:j,hours:k,day:d,month:e,year:f,"9s8fjshd324hd98s":token};$.ajax({type:"post",url:m,data:n,dataType:"json",success:function(){var a=$("#filter-criticality-analysis-history-form"),b=a.find("input[name=start_date]").val();if(""==b){var c=new Date,d=c.getDate(),e=c.getMonth()+1,f=c.getFullYear();10>d&&(d="0"+d),10>e&&(e="0"+e),c=d+"/"+e+"/"+f,a.find("input[name=start_date]").val(c),enableEndDateRange(c),a.find("input[name=end_date]").val(c)}var g,h,i=a.find("input[name=end_date]").val(),j=b.split("/"),k=j[1],l=j[0];""==i?(h=j[0],a.find("input[name=end_date]").val(b)):(g=i.split("/"),h=g[0]);var m=j[2],n=null,o=a.find("select[name=asset]").val(),p=a.find("input[name=equipment_code]").val(),q=a.find("select[name=category]").val(),r=a.find("select[name=filter_last_review_date]").val(),s=a.find("input:checked[name='filter_category[]']"),t=a.find("select[name=filter_owner]").val();if(s.length>0){var u=[];s.each(function(){u.push($(this).val())})}else u=null;var v=daysInMonth(k,m);l>v&&(l=v,a.find("select[name=start_day]").val(v)),h>v&&(h=v,a.find("select[name=end_day]").val(v)),console.log(l),getCriticalityAnalysisHistoryDailyValues(l,h,k,m,n,o,q,p,r,u,t),update_json_view("criticality_analysis"),update_json_view("criticality_analysis_compliance","compliance")}})})}function rank_document(){$("#rank-document").submit(function(a){a.preventDefault();var b=$(this).find("button[type=submit]"),c=$(this).serializeArray(),d=$(this).attr("action");b.button("loading"),$.ajax({type:"POST",url:d,data:c,dataType:"html",success:function(){get_ranking_like(),$("#like-button").attr("disabled","disabled"),$("textarea[name=ranking_comment]").attr("disabled","disabled")}}).always(function(){b.hide()})})}function moreComments(){var a="#more-comments";$(document).on("click",a,function(a){a.preventDefault();var b=$(this),c=b.data("offset");documentComments(c)})}function documentComments(a,b){var c=$("#single-document-comments"),d=$("#more-comments");if(c.length>0){var e=$("#loading"),f=$("#no-search-found"),g=$("input[name=9s8fjshd324hd98s]").val(),h=$("input[name=current_user_id]").val(),i=$("input[name=document_id]").val(),b=b||3,a=a||0,j="document_ranking/get_ranking_details",k=base_url+j,l={"9s8fjshd324hd98s":g,current_user_id:h,document_id:i,limit:b,offset:a};e.removeClass("hidden"),f.addClass("hidden"),$.ajax({type:"post",url:k,data:l,dataType:"json",success:function(g){console.log(g);{var h=g.table_data,i=g.table_info,j=g.user_info;j.current_user_id,j.session_asset_role,j.session_site_role,i.document_id}if(h.length<1)e.addClass("hidden"),f.removeClass("hidden"),d.removeClass("btn-primary"),d.addClass("btn-success"),d.html('<i class="fa fa-refresh"></i> Refresh');else{e.addClass("hidden"),f.addClass("hidden");var k=a+b,l=i.count;l>=k?d.attr("data-offset",k):d.hide(),$.each(h,function(a,b){var d="";d+='<li class="list-group-item comment-item">',d+='<div class="row">',d+='<div class="col-xs-2">',d+='<img src="'+b.user_image_path+'" class="img-circle img-responsive user-img border-grey" alt="" />',d+="</div>",d+='<div class="col-xs-10 col-md-10">',d+='<div class="comment-body">',d+='<p class="strong">'+b.ranking_comment+"</p>",d+='<div class="mic-info">',d+='By: <a href="#">'+b.full_name+"</a> on "+b.ranking_date,d+="</div>",d+="</div>",d+="</div>",d+="</div>",d+="</li>",c.append(d)});var m=$("#comment-container"),n=$("#like-container");m.text(i.comments),n.text(i.likes)}}})}}function tb_ranking(){$("#feedback_button").click(function(){$(this).find(".glyphicon").toggleClass("glyphicon-chevron-down"),$(this).closest("#ranking-container").find(".form").slideToggle()}),$(document).on("click","#like-button",function(){console.log("clicked like button");var a=($(this),$(this).find("i.fa"));a.hasClass("fa-thumbs-o-up")?(a.removeClass("fa-thumbs-o-up"),a.addClass("fa-thumbs-up")):(a.removeClass("fa-thumbs-up"),a.addClass("fa-thumbs-o-up"));var b=$(this).closest("#ranking-container").find("input[name=ranking_like]");ranking_like_value=b.val(),$(this).toggleClass("btn-like"),b.val(1==ranking_like_value?0:1)})}function get_ranking_like(){if($ranking_container=$("#ranking-container"),$ranking_container.length>0){var a=$("input[name=9s8fjshd324hd98s]").val(),b=$("input[name=document_id]").val(),c="document_ranking/get_likes",d={"9s8fjshd324hd98s":a,document_id:b,with_like_text:!0},e=base_url+c;$.ajax({type:"POST",url:e,data:d,dataType:"html",success:function(a){$(".like-count").text(a)}})}}function exportCSV(){$(document).on("click","#export-criticality-analysis",function(){var a=($(this),$(this).closest("form")),b=a.find("select[name=filter_asset]").val(),c=a.find("select[name=filter_category]").val(),d=a.find("input[name=filter_code]").val(),e=a.find("select[name=filter_last_review_date]").val(),f=a.find("select[name=filter_owner]").val();user_criticality_analysis(b,c,d,e,f,!0)}),$(document).on("click","#export-single-index",function(){var a=($(this),$(this).closest("form")),b=a.find("select[name=filter_asset]").val(),c=a.find("select[name=filter_category]").val(),d=a.find("input[name=filter_code]").val(),e=a.find("select[name=filter_last_review_date]").val(),f=a.find("select[name=filter_category]").val(),g=a.find("input:checked[name='filter_status[]']"),h=[];g.each(function(){h.push($(this).val())}),user_single_index(b,c,d,e,h,f,!0)})}function userWeeklyPlan(){var a=$("#my-weekly-plan"),b=a.find("tbody"),c=$("#loading-weekly-plan");if(a.length>0){var d=$("#no-weekly-plan"),e=$("#no-search-found"),f=$("input[name=9s8fjshd324hd98s]").val(),g=$("input[name=current_user_id]").val(),h="document/get_weekly_plan",i=base_url+h,j={"9s8fjshd324hd98s":f,user_id:g};c.removeClass("hidden"),a.hide(),e.addClass("hidden"),d.addClass("hidden"),$.ajax({type:"post",url:i,data:j,dataType:"json",success:function(e){{var f=e.table_data,g=e.table_info,h=e.user_info;h.user_id}f.length<1?(c.addClass("hidden"),a.hide(),d.removeClass("hidden")):(c.addClass("hidden"),a.show(),$.each(f,function(a,c){var d="";d+='<tr id="data-row-'+c.weekly_plan_id+'" class="data-row">',d+='<td class="work-order">',d+='<input class="form-control" type="text" name="work_order" value="'+c.work_order+'"',d+="</td>",d+='<td class="job-description">',d+='<input class="form-control" type="text" name="job_description" value="'+c.job_description+'"',d+="</td>",d+='<td class="specialist-requirement">',d+='<select name="specialist_requirement" class="form-control">',d+=g.specialist_requirement_dropdown,d+="</select>",d+="</td>",d+='<td class="category">',d+='<select name="category" class="form-control">',d+=g.category_dropdown,d+="</select>",d+="</td>",d+='<td class="date">',d+='<input class="form-control datepicker" type="text" name="weekly_plan_date" value="'+c.date+'"',d+="</td>",d+='<td class="comment">',d+='<input class="form-control" type="text" name="comment" value="'+c.comments+'"',d+="</td>",d+='<td class="status">',d+='<select name="status" class="form-control">',d+=g.status_dropdown,d+="</select>",d+="</td>",d+='<td class="text-center">',d+='<a href="#" class="btn btn-danger delete-weekly-plan"><span class="glyphicon glyphicon-minus"></span></a> ',d+='<a href="#" class="btn btn-primary update-weekly-plan"><span class="glyphicon glyphicon-floppy-disk"></span></a>',d+='<p class="comments hidden">'+c.comments+"</p>",d+='<p class="owner hidden">'+c.owner+"</p>",d+='<p class="weekly-plan-id hidden">'+c.weekly_plan_id+"</p>",d+='<p class="status-id hidden">'+c.status_id+"</p>",d+='<p class="owner-fullname hidden">'+c.owner_fullname+"</p>",d+='<p class="specialist-requirement-id hidden">'+c.specialist_requirement_id+"</p>",d+='<p class="category-id hidden">'+c.category_id+"</p>",d+="</td>",d+="</tr>",b.append(d);var e=$(d),f=("#"+e.attr("id")+" ",b.find("select[name=specialist_requirement]")),h=b.find("select[name=category]"),i=b.find("select[name=status]");f.val(c.specialist_requirement_id),h.val(c.category_id),i.val(c.status_id)}),dateEffects())}})}}function updateWeeklyPlan(){{var a=$("#my-weekly-plan");a.find("tbody"),a.find(".update-weekly-plan"),$("#loading-weekly-plan"),$("#no-search-found")}$(document).on("click","#my-weekly-plan .update-weekly-plan",function(a){a.preventDefault();var b=$(this).closest(".data-row"),c=b.find("input[name=work_order]"),d=b.find("input[name=job_description]"),e=b.find("select[name=specialist_requirement]"),f=b.find("select[name=category]"),g=b.find("input[name=weekly_plan_date]"),h=b.find("select[name=status]"),i=b.find(".weekly-plan-id"),j=b.find("input[name=comment]"),k=c.val(),l=d.val(),m=e.val(),n=f.val(),o=g.val(),p=h.val(),q=i.text(),r=j.val(),s=$("input[name=9s8fjshd324hd98s]").val(),t="weekly_plan/update",u=base_url+t,v={"9s8fjshd324hd98s":s,weekly_plan_id:q,work_order:k,job_description:l,specialist_requirement:m,category:n,date:o,comment:r,status:p};$.ajax({type:"post",url:u,data:v,dataType:"html",success:function(a){console.log(v),console.log(a)}})})}function removeWeeklyPlan(){{var a=$("#my-weekly-plan");a.find("tbody"),a.find(".delete-weekly-plan"),$("#loading-weekly-plan"),$("#no-search-found")}$(document).on("click","#my-weekly-plan .delete-weekly-plan",function(a){a.preventDefault();var b=$(this).closest(".data-row");b.fadeOut("fast");var c=$("input[name=9s8fjshd324hd98s]").val(),d=b.find(".weekly-plan-id"),e=d.text(),f="weekly_plan/remove",g=base_url+f,h={"9s8fjshd324hd98s":c,weekly_plan_id:e};$.ajax({type:"post",url:g,data:h,dataType:"html",success:function(a){console.log(h),console.log(a)},error:function(a){console.log(a.responseText)}})})}function weeklyPlanClone(){{var a="#my-weekly-plan",b="#loading-weekly-plan",c="#no-search-found",d=".row-options-container",e=".remove-row",f=".add-row",g=$(a),h=g.find("tbody");g.find(".delete-weekly-plan"),$(b),$(c),g.find(d)}$(document).on("click",a+" "+d+" "+f,function(a){a.preventDefault();var b=($(this),h.find("tr:last-child").clone());b.find("input").val(""),b.find("select").val(""),h.append(b);var c=$("input[name=9s8fjshd324hd98s]").val(),d="weekly_plan/create_empty",e=base_url+d,f={"9s8fjshd324hd98s":c,data_post:!0};$.ajax({type:"post",url:e,data:f,dataType:"html",success:function(a){console.log(a)}})}),$(document).on("click",a+" "+d+" "+e,function(a){var b=!1,c=!1;if(a.preventDefault(),$rows=h.find("tr"),$last_child=$rows.last(),$rows.length<=1?($last_child.remove(),b=!0,c=!0):($last_child.fadeOut(function(){$(this).remove()}),b=!0),b){var d=$("input[name=9s8fjshd324hd98s]").val(),e=$last_child.find(".weekly-plan-id"),f=e.text(),g="weekly_plan/remove",i=base_url+g,j={"9s8fjshd324hd98s":d,weekly_plan_id:f};$.ajax({type:"post",url:i,data:j,dataType:"html",success:function(a){console.log(a)}})}c&&userWeeklyPlan()})}function containerResize(){$(document).on("click",".navbar-sidebar-toggle",function(){$new_width=$("#criticality-analysis-per-day").width(),$("#criticality-analysis-per-day").find(".resize-column").css("width",$new_width),fixSizeAddRemoveFollowUser()})}function createWeeklyPlan(){$("a.create-weekly-plan"),$("#create-weekly-plan");$(document).on("click","a.create-weekly-plan",function(){var a=$("input[name=9s8fjshd324hd98s]").val(),b="weekly_plan/create_empty",c=base_url+b,d={"9s8fjshd324hd98s":a,data_post:!0};$.ajax({type:"post",url:c,data:d,dataType:"html",success:function(){userWeeklyPlan()}})})}function checkForCompletedForms(a){if(console.log("notification called"),$(a).length){console.log("notification start");var b=setInterval(function(){ajax_execute(a,"notify_owners",null),console.log("notification test")},5e3);setTimeout(function(){clearInterval(b)},15e4)}}function ajax_execute(a,b,c){if(null==c&&(c={}),$(a).length){var d=$("input[name=9s8fjshd324hd98s]").val(),e=($("input[name=form_id]").val(),controller+"/"+b);c["9s8fjshd324hd98s"]=d;var f=base_url+e;$.ajax({type:"POST",url:f,data:c,dataType:"html",success:function(){}})}}function fiveWhyQuestionEffects(){$(".why-question").on("change",function(){$why_questions=$(this).closest(".five-why-row").find(".five-why-questions"),"yes"!=$(this).val()?($why_questions.removeClass("hidden"),$why_questions.addClass("hidden")):$why_questions.removeClass("hidden"),$six_why_questions=$(this).closest(".six-why-row").find(".six-why-questions"),"yes"!=$(this).val()?($six_why_questions.removeClass("hidden"),$six_why_questions.addClass("hidden")):$six_why_questions.removeClass("hidden")})}function generateTickerRow(a,b,c){var d="";switch(row_state="undefined"!=typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c?"complete":"undefined"==typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c?"no_image":"undefined"==typeof a&&"undefined"==typeof b&&"undefined"!=typeof c?"content_only":"undefined"!=typeof a&&"undefined"==typeof b&&"undefined"==typeof c?"image_only":"undefined"!=typeof a&&"undefined"==typeof b&&"undefined"!=typeof c?"no_title":"title_only"){case"complete":d+='<div class="col-xs-4 no-padding"><img class="img-responsive" src="'+a+'"></div>',d+='<div class="col-xs-8">',d+="<h4>"+b+"</h4>",d+="<p>"+c+"</p>",d+="</div>";break;case"no_image":d+='<div class="col-xs-12">',d+="<h4>"+b+"</h4>",d+="<p>"+c+"</p>",d+="</div>";break;case"content_only":d+='<div class="col-xs-12">',d+="<br>",d+="<p>"+c+"</p>",d+="</div>";break;case"image_only":d+='<div class="col-xs-12">',d+='<img class="img-responsive" src="'+a+'">',d+="</div>";break;case"no_title":d+='<div class="col-xs-4 no-padding"><img class="img-responsive" src="'+a+'"></div>',d+='<div class="col-xs-8">',d+="<br>",d+="<p>"+c+"</p>",d+="</div>";break;case"title_only":d+='<div class="col-xs-12">',d+="<h4>"+b+"</h4>",d+="</div>"}return d}function ticker(){var a={tickers:[{image:"test",title:"Test",content:"the quick brown fox jumps over the lazy dog"},{title:"No Image",content:"this is a test content"},{content:"This is a content with no image and no title at all"},{image:"test2",content:"this is content with image no title"}],height:"78px",id:"sidebar-ticker",row:"ticker-row",scroll:!0},b=a.tickers;console.log(b);var c="";$.each(b,function(a,b){var d=b.image,e=b.title,f=b.content;c+='<div class="row ticker-row">',c+=generateTickerRow(d,e,f),c+="</div>"}),console.log(a),console.log("ticker called");var d=a.height,e=$("#"+a.id);e.append(c);var f=e.find("."+a.row);f.css("height",d);var g=f.height();console.log(g);var h=e.newsTicker({row_height:g,max_rows:3,duration:4e3,speed:1e3}),i=a.scroll;i&&e.css("overflow-y","scroll"),h.newsTicker("add",generateTickerRow("testimage","Test Title","hello world"))
}var toolbar_settings=[["style",["bold","italic","underline"]],["para",["ul","ol","paragraph","removeformat"]]],validator_date_validation={validators:{date:{format:"DD/MM/YYYY",message:"The value is not a valid date"}}},required_field_properties={message:"",feedbackIcons:{valid:"",invalid:"",validating:""},submitButtons:'button[type="submit"]',submitHandler:function(a,b,c){if(c.hasClass("nexttab")){var d=b.find("input[name=next_link]").val();b.find("input[name=link_to]").val(d)}validateRequiredInput(b)?a.defaultSubmit():goToByScroll("first-required")},fields:{user_date:validator_date_validation,date_of_issue:validator_date_validation,detection_date:validator_date_validation,date:validator_date_validation,estimated_start_date:validator_date_validation}};jQuery(function(){"use strict";ajaxSetup(),selectEffects(),bootstrapEffects(),tooltipsAndPopovers(),inputEffects(),tableEffects(),document_status(),user_document_status(),editUserProfile(),changePhoto(),userHistoryOfAvailability(),editLessonsToBeLearned(),addRemoveFollowUser(),getDataTable("basic-decf-json","basic-decf","BASIC-DECF"),getDataTable("decf-json","case-file","DECF"),getDataTable("ofi-json","ofi"),getDataTable("project-plan-json","project-plan"),getDataTable("technical-bulletin-json","technical-bulletin"),getDataTable("witness-statement-json","witness-statement"),getDataTable("technical-query-json","technical-query"),getDataTable("erp-json","erp","ERP"),getUserData(),navbarToggle(),dynamicRow("constraints-table","constraints",null,!1,"","default"),dynamicRow("next-steps-table","next_step"),dynamicRow("cost-breakdown-table","cost_breakdown",null,!1,"","default"),dynamicRow("benefit-breakdown-table","benefits_breakdown",null,!1,"","default"),dynamicRow("enablers-table","enabler",null,!1,"","default"),dynamicRow("enablers-prerequisite-table","prerequisite",null,!1,"","default"),dynamicRow("enablers-dependencies-table","dependency",null,!1,"","default"),dynamicRow("organisation-table","organisation",null,!1,"","default"),dynamicRow("action-tracker-table","action_tracker",null,!1,"","default-no-padding"),dynamicRow("reporting-table","reporting",null,!1,"","default"),dynamicRow("meeting-table","meeting",null,!1,"","default"),dynamicRow("action-log-table","action_log",".row",!1,"","default"),dynamicRow("change-management-table","change_management",null,!1,"","default"),dynamicRow("milestone-table","milestone",null,!1,"","default"),dynamicRow("additional-user","document_owner",".col-row"),dynamicRow("follow-user","follow_user",".col-row",!1,"","col-sm-4 col-sm-offset-7","user_id"),dynamicRow("expectation-table","expectation",null,!1,"","default-no-padding"),dynamicRow("deliverable-table","deliverable",null,!1,"","default"),dynamicRow("file-table","file",".file-row",!0),dynamicRow("rate-of-success-table","rate_of_success",null,!1,"","default"),dynamicRow("type-of-improvement-table","type_of_improvement",null,!1,"","default"),dynamicRow("failure-cause-table","failure_cause",".failure-cause-row",!1,"","default"),dynamicRow("consequence-table","failure_impact",".consequence",!1,"","default"),dynamicRow("responsible-party-table","test_process",null,!1,"","default"),dynamicRow("process-step-table","process_step"),dynamicRow("quality-control-step-table","quality_control_step",null,!1,"","default"),dynamicRow("timeline-table","timeline",null,!1,"","default"),dynamicRow("maintenance-activity-table","maintenance_activity",".row-activity",!1,"","default"),dynamicRow("report-status-table","status_report_item",".report-status-row"),dynamicRow("interested-party-role-table","interested_party",".col-row",!1,"","col-sm-4 col-sm-offset-8 no-padding"),dynamicRow("responsible-party-role-table","responsible_party",".col-row",!1,"","col-sm-4 col-sm-offset-8 no-padding"),ajax_select("#system","case-file/get_subcategory","system","#system_subcategory"),ajax_select("#equipment-category","case-file/get_subcategory","equipment_category","#equipment-class"),ajax_select("#equipment-class","case-file/get_deep_subcategory","equipment_category","#equipment-description"),ajax_select("#equipment-description","case-file/get_menu_details","equipment_category","#equipment-code",null,"deep_subcategory","code"),ajax_select("#detection_notification","case-file/get_menu_details","method_of_detection_notification","#detection_description",null,"menu","description"),ajax_select("#failure_mechanism","case-file/get_subcategory","failure_mechanism","#failure_mechanism_subdivision"),ajax_select(".failure-cause","case-file/get_subcategory","failure_cause",".failure-cause-subdivision",".failure-cause-row"),ajax_select(".failure-cause-subdivision","case-file/get_menu_details","failure_cause",".failure-cause-description",".failure-cause-row","subcategory","description"),ajax_select("#failure-notification","case-file/get_subcategory","failure_mode","#failure_description"),ajax_select("#failure_description","case-file/get_menu_details","failure_mode","#failure_code",null,"subcategory","code"),ajax_select(".type-of-improvement","ofi/get_menu_details","type_of_improvement",".type-of-improvement-description",".row.content","menu","description"),ajax_select(".maintenance-activity-item","case-file/get_menu_details","maintenance_activity",".maintenance-activity-description",".row-activity","menu","description"),textareaEffects(),delete_file_row(),checkIfSaved(),confirmDelete(),validateSteps(),option1Checker(),option2Checker(),coloredSelectEffects(),user_criticality("criticality-redundancy","criticality_redundancy","Reliability/<br>Redundancy"),user_criticality("criticality-safety","criticality_safety","Safety<br>Health<br>Criticality"),user_criticality("criticality-environment","criticality_environment","Environmental<br>Criticality"),user_criticality("criticality-operation","criticality_operation","Operational<br>Criticality"),user_criticality("criticality-reinstatement","criticality_reinstatement","Reinstatement",!0),user_criticality("criticality-status","criticality_status","Status",!1,!0),update_user_criticality(),edit_criticality_score(),user_criticality_analysis_scoring(),getActionTrackerList(),updateActionTracker(),updateSubActionTracker(),addRemoveActionTrackerButtons(),deleteSpecificRowActionTracker(),uploadFromSpecificRowActionTracker(),filterMasterActionTracker(),addSubactionTrackerRow(),toggleActionTrackerTableColumns(),createNewAttachFileRowActionTracker(),updateActionTrackerDocumentDropdown(),createActionTrackerModal(),button_scroll(),scroll_top(),enableEndDateRange(),daysInMonth(),dateRange(),user_criticality_analysis(),user_compliance_dashboard(),update_user_compliance(),update_user_single_index(),user_single_index(),user_failure_rate(),edit_failure_rate(),delete_failure_rate(),edit_criticality_analysis(),delete_criticality_analysis(),createCriticalityAnalysis(),filterCriticalityAnalysis(),filterCriticalityAnalysisValues(),getCriticalityAnalysisHistoryDailyValues(),editCriticalityAnalysisHistoryValues(),containerResize(),exportCSV(),documentComments(),moreComments(),userWeeklyPlan(),updateWeeklyPlan(),removeWeeklyPlan(),weeklyPlanClone(),createWeeklyPlan(),fixSizeAddRemoveFollowUser(),numberEffects(),hide_plus_minus_button(),checkForCompletedForms("form.check-completed"),tb_ranking(),rank_document(),get_ranking_like(),fiveWhyQuestionEffects(),ticker()}),function(a){a.fn.outerHTML=function(){return a(this).clone().wrap("<div></div>").parent().html()}}(jQuery);